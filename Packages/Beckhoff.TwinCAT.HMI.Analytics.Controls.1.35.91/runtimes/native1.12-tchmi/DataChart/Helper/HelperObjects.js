var TcHmi;!function(e){!function(e){!function(e){class t{}t.chartConfigReceived="DataSourceConfigReceived",t.dataSourceConfigStored="DataSourceConfigStored",t.dataSourcesReceived="DataSourcesReceived",t.onChartPropertyChanged="onChartPropertyChanged",t.onTimerangePropertyChanged="onTimerangePropertyChanged",e.DataChartEventNames=t;class n{static isValidDateFormat(e){return n.dateTimePattern.test(e)}static isValidInput(e){return!(!n.dateTimePattern.test(e)&&!n.nowExtendedPattern.test(e))}}let a,s,r,i,o;n.DateUnits=["d","h","w","s","m","M","y"],n.unitsPattern=n.DateUnits.join("|"),n.nowExtendedPattern=new RegExp(`^now(?:-(?<number>\\d+)(?<unit>${n.unitsPattern}))?(?:/(?<unitwithslash>${n.unitsPattern}))?$`,"i"),n.dateTimePattern=/^(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(?:\.(\d{3}))?$/,n.nowExactPattern=/^now$/i,e.RegexHelper=n,function(e){e.parseStringToDate=function(e,t=!0){const a=e.match(n.dateTimePattern);if(!a)return null;const[,s,r,i,o,l,u,c]=a;return t?new Date(Date.UTC(+s,+r-1,+i,+o,+l,+u,c?+c:0)):new Date(+s,+r-1,+i,+o,+l,+u,c?+c:0)},e.parseDateToString=function(e,t=!0){const n=(e,t)=>{const n=e.toString();return n.length>=t?n:"0".repeat(t-n.length)+n},a=t?e.getUTCFullYear():e.getFullYear(),s=t?e.getUTCMonth()+1:e.getMonth()+1,r=t?e.getUTCDate():e.getDate(),i=t?e.getUTCHours():e.getHours(),o=t?e.getUTCMinutes():e.getMinutes(),l=t?e.getUTCSeconds():e.getSeconds(),u=t?e.getUTCMilliseconds():e.getMilliseconds(),c=`${n(a,4)}-${n(s,2)}-${n(r,2)} ${n(i,2)}:${n(o,2)}:${n(l,2)}`;return 0===u?c:`${c}.${n(u,3)}`}}(a=e.TimeParser||(e.TimeParser={}));class l{constructor(e,t,n){this.number=e,this.unit=t,this.unitWithSlash=n,isNaN(e)&&(e=0)}toTimeSpan(){const e={years:0,month:0,weeks:0,days:0,hours:0,minutes:0,seconds:0};switch(this.unit){case"s":e.seconds=this.number;break;case"m":e.minutes=this.number;break;case"h":e.hours=this.number;break;case"d":e.days=this.number;break;case"w":e.weeks=this.number;break;case"M":e.month=this.number;break;case"y":e.years=this.number}return e}static parseNowExtended(e){const t=e.match(n.nowExtendedPattern);if(t){const e=parseInt(t[1],10),n=t[2],a=t[3]?t[3]:void 0;return new l(e,n,a)}return null}static parseDateTimeString(e){const t=e.match(n.dateTimePattern);return t?new Date(t[1]):null}}e.RelativeTimeSelection=l,function(e){e.ExtractFrom_I_SE_ChannelEntry=function(e){const t=[];for(const n of e){let e=t.find(e=>e.name===n.name&&e.sourceID===n.sourceID);null==e&&(e={sourceID:n.sourceID,datatype:n.datatype,name:n.name,varColors:[],visibility:[],unit:n.unit,customUnit:n.customUnit,userFalseAlias:n.userFalseAlias,userTrueAlias:n.userTrueAlias},t.push(e)),e.varColors.push(n.varColor),e.visibility.push(n.isVisible)}return t},e.ExtractChannelsFromChannelConfig=function(e,t){const n=[];let a=0;for(const s of t){for(const t of e){null==t.varColors[a]&&(t.varColors[a]=null),null==t.visibility[a]&&(t.visibility[a]=!0);const e={name:t.name,datatype:t.datatype,sourceID:t.sourceID,isVisible:t.visibility[a],varColor:t.varColors[a],isFilled:!0,unit:t.unit,customUnit:t.customUnit,userFalseAlias:t.userFalseAlias,userTrueAlias:t.userTrueAlias};n.push(e)}a++}return n},e.GetUsedSources=function(e,t){const n=[...new Set(e.map(e=>e.sourceID))],a=[];for(const e of n){const n=t.filter(t=>t.sourceID==e);null!=n&&n.length>0&&a.push(n[0])}return a},e.GetChannelUnit=function(e){return e.customUnit?e.customUnit:e.unit}}(s=e.ChannelConfigHelper||(e.ChannelConfigHelper={}));class u{static getFromTcTime(e,t){let a;if(n.dateTimePattern.test(e.from))a=new Date(e.from);else{if(!n.nowExtendedPattern.test(e.from))return console.error("no valid date"+e.from),0;{const n=l.parseNowExtended(e.from);var s=new Date(t);if(s=u.SubtractSpanFromDate(s,n.toTimeSpan()),null!=n.unitWithSlash)switch(n.unitWithSlash){case"m":a=new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),0);break;case"h":a=new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),0,0);break;case"d":a=new Date(s.getFullYear(),s.getMonth(),s.getDate());break;case"w":a=u.getPreviousMonday(s);break;case"M":a=new Date(s.getFullYear(),s.getMonth(),1);break;case"y":a=new Date(s.getFullYear(),0,1);break;default:a=s}else a=s}}const r=new Date(Date.UTC(1601,0,1)),i=a.getTime()-r.getTime();return Math.floor(1e4*i)}static SubtractSpanFromDate(e,t){let n=new Date(e.getTime());if(t.years>0&&n.setFullYear(n.getFullYear()-t.years),t.month>0&&n.setMonth(n.getMonth()-t.month),t.weeks>0){const e=7*t.weeks;n.setDate(n.getDate()-e)}return t.days>0&&n.setDate(n.getDate()-t.days),t.hours>0&&n.setHours(n.getHours()-t.hours),t.minutes>0&&n.setMinutes(n.getMinutes()-t.minutes),t.seconds>0&&n.setSeconds(n.getSeconds()-t.seconds),n}static getPreviousMonday(e){let t=(e.getDay()-1+7)%7;0===t&&(t=7);const n=new Date(e);return n.setDate(e.getDate()-t),n.setHours(0,0,0,0),n}static getToTcTime(t,a,s=null){if(null!=s){let n=this.getFromTcTime(t,a);const r=new e.SPTime(n).date;switch(s.rangeUnit){case e.TimeIntervalStrings.MilliSecond_s:r.setMilliseconds(r.getMilliseconds()+s.rangeValue);break;case e.TimeIntervalStrings.Second_s:r.setSeconds(r.getSeconds()+s.rangeValue);break;case e.TimeIntervalStrings.Minute_s:r.setMinutes(r.getMinutes()+s.rangeValue);break;case e.TimeIntervalStrings.Hour_s:r.setHours(r.getHours()+s.rangeValue);break;case e.TimeIntervalStrings.Day_s:r.setDate(r.getDate()+s.rangeValue);break;case e.TimeIntervalStrings.Week_s:r.setDate(r.getDate()+7*s.rangeValue);break;case e.TimeIntervalStrings.Month_s:r.setMonth(r.getMonth()+s.rangeValue);break;case e.TimeIntervalStrings.Year_s:r.setFullYear(r.getFullYear()+s.rangeValue)}return n=e.SPTime.convertTimeMsToTcTime(r.getTime(),a),n}{let e;if(n.dateTimePattern.test(t.to))e=new Date(t.to);else{if(!n.nowExtendedPattern.test(t.to))return console.error("no valid date"+t.to),0;{const n=l.parseNowExtended(t.to);var r=new Date(a);if(null!=n)if(r=u.SubtractSpanFromDate(r,n.toTimeSpan()),null!=n.unitWithSlash)switch(n.unitWithSlash){case"m":e=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes()+1,0);break;case"h":e=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours()+1,0,0);break;case"d":e=new Date(r.getFullYear(),r.getMonth(),r.getDate()+1);break;case"w":e=u.getNextMonday(r);break;case"M":e=new Date(r.getFullYear(),r.getMonth()+1,1);break;case"y":e=new Date(r.getFullYear()+1,0,1);break;default:e=r}else e=r;else e=r}}const s=new Date(Date.UTC(1601,0,1)),i=e.getTime()-s.getTime();return Math.floor(1e4*i)}}static getNextMonday(e){let t=(8-e.getDay())%7;0===t&&(t=7);const n=new Date(e);return n.setDate(e.getDate()+t),n.setHours(0,0,0,0),n}static isRelative(e){return null==e||null==e.from||!n.dateTimePattern.test(e.from)&&!n.dateTimePattern.test(e.to)}}e.TimeConverter=u;e.TimerangeHelper=class{static IsTimeInRange(e,t,n){const a=u.getFromTcTime(t,n),s=u.getToTcTime(t,n);return a<=e&&e<=s}},function(e){e.NONE="CompareType_None",e.ABSOLUTE_TIME="CompareType_Absolute",e.RELATIVE_TIME="CompareType_Relative",e.MATCHING_START="CompareType_MatchStart",e.MATCHING_END="CompareType_MatchEnd"}(r=e.ECompareChartCompareTypes||(e.ECompareChartCompareTypes={})),function(e){e.NONE="FillMode_None",e.FILL="FillMode_Fill"}(i=e.EFillMode||(e.EFillMode={})),function(e){e[e.Right=0]="Right",e[e.Left=1]="Left"}(o=e.YAxisPosition||(e.YAxisPosition={}))}(e.Analytics||(e.Analytics={}))}(e.Controls||(e.Controls={}))}(TcHmi||(TcHmi={}));