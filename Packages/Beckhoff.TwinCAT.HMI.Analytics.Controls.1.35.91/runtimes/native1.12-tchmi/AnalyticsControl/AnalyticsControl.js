var TcHmi;!function(t){let e;!function(e){let i;!function(e){class i extends t.Controls.System.TcHmiControl{static get MEA_BLUE(){return"#3b5e9e"}constructor(t,e,i){super(t,e,i),this.__elCustomElements=[],this.__hasLicense=!0,this.__hasFullLicense=!1,this.__hasTitleArea=!0,this.__localizedElements=new Map,this.__destroyLocalizationWatch=null,this.__originalPropertyValues=new Map,this.__customPropSetting=!1,this.__preventEditAreaToggle=!1,this.__maxFontSizes=new Map,this.COLLAPSE_CLASS="tchmi-analytics-collapse",this.__htmlCodeCloseIcon='<svg class="tchmi-analytics-control-close tchmi-analytics-text tchmi-box" viewBox="0 0 24 24" width="24px" height="24px"><path d = "M7 7 L17 17 M17 7 L7 17" stroke-width="2" stroke = "currentColor" fill = "none" />></svg>',this.local=void 0,this.__onResized=()=>(t,e)=>{},this.__editPropertiesAlias="Edit properties"}__previnit(){super.__previnit(),e.Utilities.persistentDataRequested||(e.Utilities.clearPersistentData(),e.Utilities.__getPersistentDataFromSerExt(),e.Utilities.persistentDataRequested=!0),this.__eventListenerManager=new e.EventListenerManager,this.__eventListenerManager.addEventListener(document,t.AnalyticsControlEventNames.KeyValuePairsReceived,()=>this.__processCustomEdits()),this.__elementTemplateRoot=this.__element.find(".tchmi-analytics-control-template"),this.__elTemplateContainer=this.__elementTemplateRoot.find(".tchmi-analytics-control-template-container"),this.__elThis=$(this.__elementTemplateRoot[0].parentElement),this.__elTitleArea=this.__elementTemplateRoot.find(".tchmi-analytics-control-title-area"),this.__elementNameAlias=this.__elementTemplateRoot.find(".tchmi-analytics-control-name-alias"),this.__elEdit=$([]),this.__elEditArea=$([]),this.__elEditAreaItem=$([]),this.__elProperties=$([]),this.__elDimMask=$([]),this.__elEditAreaEditProperties=$([]),this.__elWarning=$([]),this.__elementsText=this.__elementTemplateRoot.find(".tchmi-analytics-text"),this.__elementsSVGMask=this.__elementTemplateRoot.find(".tchmi-analytics-svg-mask"),this.__elementReset=this.__elementTemplateRoot.find(".tchmi-analytics-control-reset"),this.__elementsDesign=this.__elementTemplateRoot.find(".tchmi-analytics-control-design"),this.__secureId=this.__id.replace(/\(|\)/g,"_"),this.__editAreaItems=[new e.EditAreaItem("tchmi-analytics-edit-properties",this.__editPropertiesAlias,'url("/Beckhoff.TwinCAT.HMI.Analytics.Controls/AnalyticsControl/Images/properties.png")',null,this.__onPropertiesClicked())],this.__propertyWindowOptions={heading:"Analytics"},this.checkLicense(),this.__functionResultChangedDestroyEvent=t.EventProvider.register(`${this.__id}.onFunctionResultChanged`,(t,e)=>{this.__customPropSetting||e.forEach(t=>{let e=t.substring(3),i=this.__originalPropertyValues.get(e);if(void 0!==i){let s=this[t]();void 0!==s&&(i.originalValue=s,void 0!==i.modifiedValue&&(this.__customPropSetting=!0,this["set"+e](i.modifiedValue),this.__customPropSetting=!1))}})}),this.__initLocalizations()}__init(){super.__init(),this.__hasTitleArea&&this.addEventListener(this.__elementReset[0],"mousedown",this.__onResetClicked()),void 0!==this.__editableProperties&&this.__processCustomEdits()}__attach(){super.__attach(),this.__resizeDestroyEvent=t.EventProvider.register(this.__id+".onResized",this.__onResized()),this.__createEditArea(this.__editAreaItems),this.__processColor(),this.__processBackgroundColor()}__detach(){super.__detach(),this.removeEventListeners(),this.__resizeDestroyEvent&&(this.__resizeDestroyEvent(),this.__resizeDestroyEvent=void 0),this.__destroyLocalizationWatch&&(this.__destroyLocalizationWatch(),this.__destroyLocalizationWatch=void 0),this.__functionResultChangedDestroyEvent&&(this.__functionResultChangedDestroyEvent(),this.__functionResultChangedDestroyEvent=void 0)}destroy(){this.__keepAlive||(this.__onPropCloseClicked()(),super.destroy())}__onResetClicked(){let e=this;return()=>{void 0!==this.__resetSymbol?this.__resetSymbol.write("True",(function(i){i.error!==t.Errors.NONE&&e.Log("Reset failed")})):this.Log('No reset symbol found for Control "'+this.__id+'".')}}__onResizedBase(t,i){const s=this.__getScaleFactors();if(0==this.__hasLicense)return null;const o=e.Utilities.getSize(this.__elTemplateContainer[0]);let n=s.width;n>s.height&&(n=s.height);let r=o.width;return r>o.height&&(r=o.height),{default:n,width:s.width,height:s.height,vpDefault:r,vpWidth:o.width,vpHeight:o.height,valid:o.width>=0&&o.height>=0}}__getFontScaleFactor(t,e){let i=this.getRenderedWidth(),s=this.getRenderedHeight();return void 0===t&&(t=this.__defaultWidth),void 0===e&&(e=this.__defaultHeight),i/t>s/e?s/e:i/t}__getScaleFactor(t=!1){var e;if(t&&(e=this.__getFontScaleFactor()),!t){let t=this.__defaultHeight+18-this.__elementNameAlias[0].clientHeight;var i=t/this.__defaultHeight;e=this.__getFontScaleFactor(void 0,t)*i}return e}__getScaleFactors(){const t=this.__elTemplateContainer[0].getBoundingClientRect();let e=t.width,i=t.height;return{width:e/this.__defaultWidth,height:i/(this.__defaultHeight-27)}}setNameAlias(e){var i=t.ValueConverter.toString(e);null===i&&(i=this.getAttributeDefaultValueInternal("NameAlias")),i!==this.__nameAlias&&(this.__nameAlias=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getNameAlias"]),this.__processNameAlias())}getNameAlias(){return this.__nameAlias}setAndSaveNameAlias(t){this.setNameAlias(t);const e=this.__getNameAliasProperty();this.__setPropertyPersistent(e,t)}__processNameAlias(){null!=this.__nameAlias&&this.__elementNameAlias.text(this.__nameAlias),t.EventProvider.raise(`${this.__id}.onResized`,null)}setShowTitle(e){var i=t.ValueConverter.toBoolean(e);null===i&&(i=this.getAttributeDefaultValueInternal("ShowTitle")),i!==this.__showTitle&&(this.__showTitle=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getShowTitle"]),this.__processShowTitle())}getShowTitle(){return this.__showTitle}__processShowTitle(){this.__showTitle&&this.__hasTitleArea?(this.__elementNameAlias.css("display","inline-block"),this.__elTitleArea.css("padding-top","5px")):(this.__elementNameAlias.css("display","none"),this.__elTitleArea.css("padding-top","0px")),this.__processFontsizeTitle()}setShowEditProperties(e){var i=t.ValueConverter.toBoolean(e);null===i&&(i=this.getAttributeDefaultValueInternal("ShowEditProperties")),i!==this.__showEditProperties&&(this.__showEditProperties=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getShowEditProperties"]),this.__processShowEditProperties())}getShowEditProperties(){return this.__showEditProperties}__processShowEditProperties(){this.__createEditArea(this.__editAreaItems)}setFontColor(e){let i=(null==e?void 0:e.color)?this.rgbaToHex(e.color):null;null===i&&(e=this.getAttributeDefaultValueInternal("FontColor"),i=this.rgbaToHex(e.color)),i!==this.__fontColor&&(this.__fontColor=i,this.__solidFontColor=e,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getFontColor"]),this.__processFontColor())}getFontColor(){return this.__solidFontColor}__processFontColor(){null!=this.__fontColor&&(this.__elementsText.css("color",this.__fontColor),this.__elementTemplateRoot.css("--tchmi-analytics-svg-mask-color",this.__fontColor),this.__elementsSVGMask=this.__elementTemplateRoot.find(".tchmi-analytics-svg-mask"),this.__elementsSVGMask.css("background-color",this.__fontColor),this.__elementsSVGMask.css("stroke",this.__fontColor),this.__elementsDesign.css("color",this.__fontColor),this.__elementsDesign.css("border-color",this.__fontColor)),this.__processColor()}setColorDarkArea(e){var i=t.ValueConverter.toString(this.rgbaToHex(e.color));null===i&&(i=this.getAttributeDefaultValueInternal("ColorDarkArea")),i!==this.__colorDarkArea&&(this.__colorDarkArea=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getColorDarkArea"]),this.__processColor())}getColorDarkArea(){return this.rgbaToHex(this.__colorDarkArea)}setControlColorLight(e){var i=t.ValueConverter.toString(this.rgbaToHex(e.color));null===i&&(i=this.getAttributeDefaultValueInternal("ControlColorLight")),i!==this.__controlColorLight&&(this.__controlColorLight=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getControlColorLight"]),this.__processColor())}getControlColorLight(){return this.rgbaToHex(this.__controlColorLight)}setControlColorLightPlus(e){var i=t.ValueConverter.toString(this.rgbaToHex(e.color));null===i&&(i=this.getAttributeDefaultValueInternal("ControlColorLightPlus")),i!==this.__controlColorLightPlus&&(this.__controlColorLightPlus=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getControlColorLightPlus"]),this.__processColor())}getControlColorLightPlus(){return this.rgbaToHex(this.__controlColorLightPlus)}setControlColorMiddle(e){var i=t.ValueConverter.toString(this.rgbaToHex(e.color));null===i&&(i=this.getAttributeDefaultValueInternal("ControlColorMiddle")),i!==this.__controlColorMiddle&&(this.__controlColorMiddle=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getControlColorMiddle"]),this.__processColor())}getControlColorMiddle(){return this.rgbaToHex(this.__controlColorMiddle)}setControlColorDark(e){var i=t.ValueConverter.toString(this.rgbaToHex(e.color));null===i&&(i=this.getAttributeDefaultValueInternal("ControlColorDark")),i!==this.__controlColorDark&&(this.__controlColorDark=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getControlColorDark"]),this.__processColor())}getControlColorDark(){return this.rgbaToHex(this.__controlColorDark)}getControlChartColor(){return this.rgbaToHex(this.__controlChartColor)}setControlChartColor(e){var i=t.ValueConverter.toString(this.rgbaToHex(e.color));null===i&&(i=this.getAttributeDefaultValueInternal("ControlChartColor")),i!==this.__controlChartColor&&(this.__controlChartColor=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getControlChartColor"]),this.__processColor())}__processColor(){this.__component1Color=this.__controlColorLightPlus;const t=this.getBackgroundColor();let i;if(null!=t){const s=this.__elementTemplateRoot.find(".tchmi-analytics-background");i=e.Str.colorToString(t),s.css("background",i)}this.__elementTemplateRoot.find(".tchmi-analytics-component-1").css("background-color",this.__controlColorLightPlus);const s=this.__elementTemplateRoot.find(".tchmi-analytics-component-2");this.__isDarkTheme?this.__component2Color=this.__colorDarkArea:this.__component2Color=this.__controlChartColor,s.css("background-color",this.__component2Color);for(const e of this.__elCustomElements)e.fontColor=this.__fontColor,e.component1Color=this.__component1Color,e.component2Color=this.__component2Color,void 0!==t&&(e.backgroundColor=i)}setShowReset(e){var i=t.ValueConverter.toBoolean(e);null!==i?(this.__showReset=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getShowReset"]),this.__processShowReset()):i=this.getAttributeDefaultValueInternal("ShowReset")}getShowReset(){return this.__showReset}__processShowReset(){this.__showReset?(this.__elementReset.css("visibility","visible"),this.__elementNameAlias.css("padding-right","16px")):(this.__elementReset.css("visibility","hidden"),this.__elementNameAlias.css("padding-right","0px"))}setReset(e){var i=e;null!==i?i!==this.__resetSymbol&&(this.__resetSymbol=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getReset"]),this.__processReset()):i=this.getAttributeDefaultValueInternal("Reset")}getReset(){return this.__resetSymbol}__processReset(){}getFontsizeTitle(){return this.__fontsizeTitle}setFontsizeTitle(e){var i=t.ValueConverter.toNumber(e);null===i&&(i=this.getAttributeDefaultValueInternal("FontsizeTitle")),i!==this.__fontsizeTitle&&(this.__fontsizeTitle=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getFontsizeTitle"]),this.__processFontsizeTitle())}__processFontsizeTitle(){if(null!=this.__fontsizeTitle&&null!=this.__showTitle){this.__elementNameAlias.css("font-size",this.__fontsizeTitle+"px");let t=this.__fontsizeTitle;t<14&&(t=this.__hasTitleArea&&0!==this.__elEditAreaItem.length?14:0),this.__elEdit.css("width",t/22*13),this.__elEdit.css("height",t/22*8)}t.EventProvider.raise(`${this.__id}.onResized`,null)}setFontSize(e){let i=t.ValueConverter.toNumber(e);null===i&&(i=this.getAttributeDefaultValueInternal("FontSize")),i!==this.__fontSize&&(this.__fontSize=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getFontSize"]),this.__processFontSize())}getFontSize(){return this.__fontSize}__processFontSize(){}setAutoFontSize(e){let i=t.ValueConverter.toBoolean(e);null===i&&(i=this.getAttributeDefaultValueInternal("AutoFontSize")),i!==this.__autoFontSize&&(this.__autoFontSize=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getAutoFontSize"]),this.__processAutoFontSize())}getAutoFontSize(){return this.__autoFontSize}__processAutoFontSize(){}getColorGradient(){return this.__colorGradient}setColorGradient(e){var i=t.ValueConverter.toNumber(e);null===i&&(i=this.getAttributeDefaultValueInternal("ColorGradient")),i!==this.__colorGradient&&(this.__colorGradient=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getColorGradient"]),this.__processColorGradient())}__processColorGradient(){this.__processColor()}setAmountDecimals(e){var i=t.ValueConverter.toNumber(e);null===i&&(i=this.getAttributeDefaultValueInternal("AmountDecimals")),i<0&&(i=0),i!==this.__amountDecimals&&(this.__amountDecimals=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getAmountDecimals"]),this.__processAmountDecimals())}getAmountDecimals(){return this.__amountDecimals}__processAmountDecimals(){}setDefaultMinHeight(e){let i=t.ValueConverter.toNumber(e);null===i&&(i=this.getAttributeDefaultValueInternal("DefaultMinHeight")),i!==this.__defaultMinHeight&&(this.__defaultMinHeight=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getDefaultMinHeight"]),this.__processDefaultMinHeight())}getDefaultMinHeight(){return this.__defaultMinHeight}__processDefaultMinHeight(){}setEditPropertiesAlias(e){var i=t.ValueConverter.toString(e);null===i&&(i=this.getAttributeDefaultValueInternal("EditPropertiesAlias")),i!==this.__editPropertiesAlias&&(this.__editPropertiesAlias=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getEditPropertiesAlias"]),this.__processEditPropertiesAlias())}getEditPropertiesAlias(){return this.__editPropertiesAlias}__processEditPropertiesAlias(){this.__elEditAreaEditProperties.html(this.__editPropertiesAlias)}setShowPopupMessages(e){let i=t.ValueConverter.toBoolean(e);null===i&&(i=this.getAttributeDefaultValueInternal("ShowPopupMessages")),i!==this.__showPopupMessages&&(this.__showPopupMessages=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getShowPopupMessages"]),this.__processShowPopupMessages())}getShowPopupMessages(){return this.__showPopupMessages}__processShowPopupMessages(){}__initLocalizations(){let e=this.__element[0].querySelectorAll("[data-tchmi-localized-content-key]");for(let t=0,i=e.length;t<i;t++){let i=e[t],s=i.dataset.tchmiLocalizedContentKey;s&&this.__localizedElements.set(i,{key:s,parameters:null})}this.__destroyLocalizationWatch=this.__localization.watch(e=>{e.error===t.Errors.NONE&&e.reader&&(this.local=e.reader,this.__processLocalizationReader())})}__processLocalizationReader(){for(const[t,e]of this.__localizedElements){let i=this.local.get(e.key);e.key.includes("Tooltip")?t.title=tchmi_decode_control_characters(i):t.textContent=tchmi_decode_control_characters(i)}}__processPropertyValues(){}CreateRadialGradient(t,e,i,s,o=0,n=1,r=1){var a=document.createElementNS("http://www.w3.org/2000/svg","radialGradient");a.setAttribute("id",s),a.setAttribute("r","50%"),a.setAttribute("fx","65%"),a.setAttribute("fy","35%");var l=document.createElementNS("http://www.w3.org/2000/svg","stop");l.setAttribute("offset",o.toString()+"%"),l.setAttribute("style","stop-color:"+this.GetColorGradientLighter(t,i)+";stop-opacity: "+n.toString()),a.appendChild(l);var c=document.createElementNS("http://www.w3.org/2000/svg","stop");c.setAttribute("offset","100%"),c.setAttribute("style","stop-color:"+t+";stop-opacity: "+r.toString()),a.appendChild(c),e.appendChild(a)}CreateLinearGradient(t,e,i,s){const o=this.GetColorGradientLighter(t,i),n=this.GetColorGradientDarker(t,i),r=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");r.setAttribute("id",s),r.setAttribute("x1","0%"),r.setAttribute("x2","100%"),r.setAttribute("y1","0%"),r.setAttribute("y2","0%");const a=document.createElementNS("http://www.w3.org/2000/svg","stop");a.setAttribute("offset","0%"),a.setAttribute("style",`stop-color:${n};stop-opacity: 1`),r.appendChild(a);const l=document.createElementNS("http://www.w3.org/2000/svg","stop");l.setAttribute("offset","65%"),l.setAttribute("style",`stop-color:${o};stop-opacity: 1`),r.appendChild(l);const c=document.createElementNS("http://www.w3.org/2000/svg","stop");c.setAttribute("offset","100%"),c.setAttribute("style",`stop-color:${n};stop-opacity: 1`),r.appendChild(c),e.appendChild(r)}CreateLinearGradient2(t,e,i,s){var o=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");o.setAttribute("id",s),o.setAttribute("x1","0%"),o.setAttribute("x2","100%"),o.setAttribute("y1","100%"),o.setAttribute("y2","0%");var n=document.createElementNS("http://www.w3.org/2000/svg","stop");n.setAttribute("offset","0%"),n.setAttribute("style","stop-color:"+t+";stop-opacity: 1"),o.appendChild(n);var r=document.createElementNS("http://www.w3.org/2000/svg","stop");r.setAttribute("offset","100%"),r.setAttribute("style","stop-color:"+this.GetColorGradientLighter(t,i)+";stop-opacity: 1"),o.appendChild(r),e.appendChild(o)}CreateLinearGradientTwoColors(t,e,i,s,o){var n=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");n.setAttribute("id",o),n.setAttribute("x1","0%"),n.setAttribute("x2","100%"),n.setAttribute("y1","0%"),n.setAttribute("y2","0%");var r=document.createElementNS("http://www.w3.org/2000/svg","stop");r.setAttribute("offset","0%"),r.setAttribute("style","stop-color:"+t+";stop-opacity: 1"),n.appendChild(r);var a=document.createElementNS("http://www.w3.org/2000/svg","stop");a.setAttribute("offset","100%"),a.setAttribute("style","stop-color:"+e+";stop-opacity: 1"),n.appendChild(a),i.appendChild(n)}generateColor(t,e,i){var s=t.replace("rgba(","").replace(")","").split(","),o=e.replace("rgba(","").replace(")","").split(","),n=i-1;0==n&&(n=1);for(var r=[],a=parseInt(o[0])-parseInt(s[0]),l=parseInt(o[1])-parseInt(s[1]),c=parseInt(o[2])-parseInt(s[2]),_=0;_<=n;_++){var h=a*_/n+parseInt(s[0]),d=l*_/n+parseInt(s[1]),m=c*_/n+parseInt(s[2]),p="rgb("+Math.round(h)+", "+Math.round(d)+", "+Math.round(m)+")";r.push(p)}return r}polarToCartesian(t,e,i,s){var o=(s-90)*Math.PI/180;return{x:t+i*Math.cos(o),y:e+i*Math.sin(o)}}describeArc(t,e,i,s,o){const n=i;var r=this.polarToCartesian(t,e,i,o),a=this.polarToCartesian(t,e,i,s),l=o-s<=180?"0":"1";let c;return c=0===s&&360===o?`M ${r.x} ${r.y} m ${-n}, ${n} a ${n},${n} 0 1,0 ${2*n},0 a ${n},${n} 0 1,0 ${2*-n},0`:["M",r.x,r.y,"A",i,i,0,l,0,a.x,a.y].join(" "),c}checkLicense(){let e=document.createElement("div");e.setAttribute("class","tchmi-analytics-control-demo-overlay"),this.__elementTemplateRoot[0].appendChild(e);let i=document.createElement("div");i.innerHTML="No License Found!",i.setAttribute("class","tchmi-analytics-control-demo-text");let s=document.createElement("div");s.setAttribute("class","tchmi-analytics-control-beckhoff-text"),s.innerHTML="(c) Beckhoff Automation GmbH & Co KG",this.__elementTemplateRoot[0].appendChild(s);t.Server.requestEx({requestType:"ReadWrite",commands:[{symbol:"ADS.CheckLicense",writeValue:"EE499E71-9522-4C05-86B4-8AD0F904E0C4",commandOptions:["SendWriteValue","SendErrorMessage"]}]},null,o=>{if(void 0!==o&&void 0!==o.response&&0==o.error){let n;try{n=t.ValueConverter.toObject(o.response.commands[0].readValue).result}catch(t){n=0}if(0===n)this.__hasFullLicense=!0,e.style.display="none",i.style.display="none",s.style.display="none";else if(596===n){let t=document.createElement("div");t.classList.add("tchmi-analytics-control-demo-text-container"),i.innerHTML="Demo<br>Trial License",i.classList.add("tchmi-analytics-control-demo-text-trial"),this.__elementReset[0].style.zIndex="102",t.appendChild(i),this.__elementTemplateRoot[0].appendChild(t)}else this.__elementTemplateRoot[0].innerHTML="",this.__elementTemplateRoot[0].appendChild(e),this.__elementTemplateRoot[0].appendChild(i),i.style.color="white",i.style.top="2px",i.style.left="5px",i.style.verticalAlign="top",i.style.whiteSpace="break-word",i.style.display="block",s.innerHTML="© Beckhoff Automation GmbH & Co KG",this.__elementTemplateRoot[0].appendChild(s),i.innerHTML=1828===n?"No Analytics Runtime License Found!":1829===n?"Analytics Runtime License Expired!":1830===n?"Analytics Runtime License Exceeded!":1831===n?"Analytics Runtime License Invalid!":1832===n?"Analytics Runtime License Invalid System ID!":1833===n?"Analytics Runtime License not time limited!":1834===n?"Analytics Runtime License issue time in the future!":1835===n?"Analytics Runtime License time period to long!":"No Analytics Runtime License Found!",i.title="Use trial license for test purposes. The license has to be on the device where the HMI Server is running.",this.__hasLicense=!1,i.style.display="block",s.style.display="block",e.style.display="block",e.style.backgroundColor="rgba(0,0,0,1)",this.__elementNameAlias.text(""),this.__elementTemplateRoot[0].appendChild(i),t.EventProvider.raise(this.__id+".onResized",null)}})}rgbaToHex(t,i=!1){return null==t?null:e.Str.rgbaToHex(t)}LightenDarkenColor(t,e){var i=this.rgbaToHex(t).substring(1);"#"==i[0]&&(i=i.slice(1));var s=parseInt(i,16),o=(s>>16)+e;o>255?o=255:o<0&&(o=0);var n=(s>>8&255)+e;n>255?n=255:n<0&&(n=0);var r=(255&s)+e;r>255?r=255:r<0&&(r=0);var a="#"+(r|n<<8|o<<16).toString(16);return this.hexToRgbA(a)}GetColorGradientDarker(t,e){return this.__getColorGradient(t,e,!1)}GetColorGradientLighter(t,e){return this.__getColorGradient(t,e,!0)}__getColorGradient(t,i,s){i>100?i=100:i<0&&(i=0);let o=1+i/100;s||(o=1/o);const[n,r,a,l]=e.Utilities.RGBAToArray(t);let c=n*o,_=r*o,h=a*o;return c>255?c=255:c<=0&&(c=0),_>255?_=255:_<=0&&(_=0),h>255?h=255:h<=0&&(h=0),`rgba(${c}, ${_}, ${h}, ${l})`}hexToRgbA(t){return e.Str.hexToRgbA(t)}getColors(){var t=[];return["rgba(0,255,255,1)","rgba(255,0,255,1)","rgba(255,255,0,1)","rgba(220,20,60,1)","rgba(128,128,0,1)","rgba(70,130,180,1)","rgba(205,92,92,1)","rgba(0,128,0,1)","rgba(0,128,128,1)","rgba(255,127,80,1)","rgba(127,255,0,1)","rgba(30,144,255,1)","rgba(255,0,0,1)","rgba(127,255,212,1)","rgba(210,105,30)"].forEach(e=>{t.push(this.rgbaToHex(e))}),t}DateTimeConverter(t,i,s,o=!1,n=!1){let r="";if(null!=t)if(e.DCTimestruct.isValid(t)){let e=t.wYear,a=t.wMonth,l=t.wDay,c=t.wHour,_=t.wMinute,h=t.wSecond,d=t.wMilliseconds,m="";if((e>(new Date).getFullYear()||null==e||e<0)&&(e="0000"),(null==a||a<1||a>12)&&(a="00"),null!=i)switch(a){case 1:a=i.split(",")[0];break;case 2:a=i.split(",")[1];break;case 3:a=i.split(",")[2];break;case 4:a=i.split(",")[3];break;case 5:a=i.split(",")[4];break;case 6:a=i.split(",")[5];break;case 7:a=i.split(",")[6];break;case 8:a=i.split(",")[7];break;case 9:a=i.split(",")[8];break;case 10:a=i.split(",")[9];break;case 11:a=i.split(",")[10];break;case 12:a=i.split(",")[11]}(l>31||l<0||null==l)&&(l="00"),l<10&&(l="0"+l),(c>24||c<0||null==c)&&(c="00"),!0===o&&(c<=11&&c>=1&&(m=" AM"),c<=24&&c>=13&&(c-=12,m=" PM"),12===c&&(m=" PM"),0===c&&(c=12,m=" AM")),c<10&&(c="0"+c),(_>60||_<0||null==_)&&(_="00"),_<10&&(_="0"+_),(h>60||h<0||null==h)&&(h="00"),h<10&&(h="0"+h),d<10?d="00"+d:d<100?d="0"+d:(d>1e3||d<0||null==d||0===d)&&(d="000"),d=!0===s?"."+d:"",r=1==n?c+":"+_+":"+h+d+m+"<br>"+l+". "+a+" "+e:l+". "+a+" "+e+" "+c+":"+_+":"+h+d+m}else r="-";return r}TimeSpanConverter(t,e,i,s){if(null!=t){let n=t.wDays,r=t.wHours,a=t.wMinutes,l=t.wSeconds,c=t.wMilliseconds,_="";s&&(_=" "),n<10&&(n="0"+n),(n<0||null==n)&&(n="00"),r<10&&(r="0"+r),(r<0||null==r)&&(r="00"),a<10&&(a="0"+a),(a>60||a<0||null==a)&&(a="00"),l<10&&(l="0"+l),(l>60||l<0||null==l)&&(l="00"),c<10?c="00"+c:c<100?c="0"+c:(c>1e3||c<0||null==c||0===c)&&(c="000");var o=" ";return"Day"===i&&(o="s"),"Tag"===i&&(o="e"),"Päivä"===i&&(o="ä"),!1===e?1===t.wDays?n+" "+i+" "+_+r+":"+a+":"+l:t.wDays>1?n+" "+i+o+" "+r+":"+a+":"+l:r>0?r+":"+a+":"+l:a>0?"00:"+a+":"+l:"00:00:"+l:1===t.wDays?n+" "+i+" "+_+r+":"+a+":"+l+"."+c:t.wDays>1?n+" "+i+o+" "+r+":"+a+":"+l+"."+c:r>0?r+":"+a+":"+l+"."+c:a>0?"00:"+a+":"+l+"."+c:"00:00:"+l+"."+c}return""}convertTimeSpan(t){return t.wNanoseconds/Math.pow(10,9)+t.wMicroseconds/Math.pow(10,6)+t.wMilliseconds/Math.pow(10,3)+t.wSeconds+60*t.wMinutes+3600*t.wHours+3600*t.wDays*24}getFormattedString(t,i,s,o,n=""){if(null==t)return"-";if(e.Utilities.isNumeric(t))return this.getTrimmedNumber(t,n);{const r="object"==typeof t?t:e.Utilities.tryParseJson(t);if(r){if(e.Utilities.isIDCTimestruct(r)){const t=e.DCTimestruct.fromObject(r);return t.showMilliseconds=!0,t.toString()}if(e.Utilities.isIAlyTimeSpan(r))return e.TimeSpan.fromObject(r).toString(o,s,!1);if(e.Utilities.isNumberArray(r))return this.getTrimmedNumberArray(t,n)}else if(e.Utilities.isString(t))return this.getTrimmedTimestamp(t,i)}return t.toString()}getTrimmedValueWithUnit(t,e,i,s=""){const o=this.getFormattedString(t,i,"day",!0,s);return null==e||0==e.length?o:`${o} ${e}`}getTrimmedNumber(t,i="",s=this.__amountDecimals){return e.Str.getTrimmedNumber(t,s,this.__id,i)}getTrimmedNumberArray(t,e="",i=this.__amountDecimals){return t.map(t=>this.getTrimmedNumber(t,e,i)).join(", ")}getTrimmedNumberWithUnit(t,i,s="",o=!1){return e.Str.getTrimmedNumberWithUnit(t,i,this.__amountDecimals,this.__id,s,o)}getTrimmedTimestamp(t,i){if(null==t)return"";if(t.length>10&&"-"==t[10]){var s=t.substr(0,10)+"T"+t.substr(11);t=this.DateTimeConverter(e.DCTimestruct.fromTime(Date.parse(s)),i,!1)}return t}getDownscaledFontSize(t,e){let i=this.__maxFontSizes.get(t);return(void 0===i||e<i)&&(i=e,this.__maxFontSizes.set(t,i)),i}__processBackgroundColor(){super.__processBackgroundColor();let i=this.getBackgroundColor(),s=t.ValueConverter.toString(i);null==s&&(s="");let o=e.Utilities.RGBAToArray(s);o[3]>.1&&1*o[0]+1*o[1]+1*o[2]<250?this.setTheme(!0):this.setTheme(!1),this.__processColor()}scaleDownFontToFit(t){for(;t.scrollWidth>t.offsetWidth&&t.scrollWidth>parseFloat(getComputedStyle(t).width)+.5;){let e=parseFloat(window.getComputedStyle(t,null).getPropertyValue("font-size"));if(isNaN(e))break;if(e<6)break;t.style.fontSize=e-1+"px"}}__autoSize(t,i,s,o={}){return e.Utilities.autoSize(t,i,s,this.__id,o)}__resetAutoSize(e=""){t.Controls.Analytics.Utilities.resetAutoSize(this.__id,e)}__getAutoGrowValue(t,i,s=6e4){return e.Utilities.getAutoGrowValue(t,this.__id,i,s)}__resetGetAutoGrowValue(e=""){t.Controls.Analytics.Utilities.resetGetAutoGrowValue(this.__id,e)}__displayNone(t,e){t instanceof jQuery?t.toggleClass("tchmi-analytics-display-none",e):t instanceof HTMLElement&&t.classList.toggle("tchmi-analytics-display-none",e)}Log(i,s){null==s&&(s="");let o=` [${this.__classNames}] ${s} `;e.Utilities.isString(i)?o+=i:i instanceof Error?o+=`${i.message}, Stack: ${i.stack}`:o+="Unknown error.",t.Log.error(o)}__logIfError(e){e.error!==t.Errors.NONE&&console.error(e.details.message)}__getContainerSize(){return{width:this.__elTemplateContainer[0].getBoundingClientRect().width-10,height:this.__elTemplateContainer[0].getBoundingClientRect().height-5}}__hide(t){t instanceof jQuery?t.addClass("tchmi-analytics-display-none"):t.classList.add("tchmi-analytics-display-none")}__show(t,e){e?t instanceof jQuery?t.removeClass("tchmi-analytics-display-none"):t.classList.remove("tchmi-analytics-display-none"):this.__hide(t)}setTheme(t){t!==this.__isDarkTheme&&(this.__isDarkTheme=t,this.__processTheme())}__processTheme(){this.__isDarkTheme?(this.__elementReset.removeClass("tchmi-analytics-control-reset"),this.__elementReset.addClass("tchmi-analytics-control-reset-white")):(this.__elementReset.removeClass("tchmi-analytics-control-reset-white"),this.__elementReset.addClass("tchmi-analytics-control-reset"))}setEditableProperties(t,i=!0){if(i){t=[this.__getNameAliasProperty(),new e.Property(this,"ShowTitle","Show Title",e.E_DataType.BOOLEAN),new e.Property(this,"FontsizeTitle","Fontsize Title",e.E_DataType.UINTEGER)].concat(t)}this.__editableProperties=t}__getNameAliasProperty(){return new e.Property(this,"NameAlias","Title",e.E_DataType.STRING)}drawWarning(t){let e;0===this.__elWarning.length?(e=document.createElement("div"),e.className="tchmi-analytics-warning",this.__elWarning=this.__elWarning.add(e),this.__elementTemplateRoot.append(e)):e=this.__elWarning[0],e.title=t}removeWarning(){this.__elWarning.remove(),this.__elWarning=$([])}addEventListener(t,e,i,s=!1,...o){this.__eventListenerManager.addEventListener(t,e,i,s,...o)}removeEventListeners(t){this.__eventListenerManager.removeEventListeners(t)}addPropWindowEventListener(t,e,i,s=!1){this.addEventListener(t,e,i,s,"PropWindow")}addOtherElementClickedEvent(t,i,...s){this.addEventListener(document,"mousedown",(function(s){e.Utilities.isEqualOrParent(s.target,t)||i()}),!1,...s)}__removePropWindowEventListeners(){this.removeEventListeners("PropWindow")}__onEditClicked(){let t=this;return e=>{e.preventDefault(),t.__elEdit.toggleClass("tchmi-analytics-control-edit-active"),t.__elEditArea.toggleClass("tchmi-analytics-control-edit-area-active"),t.__elEditAreaItemContainer.removeClass("tchmi-analytics-control-edit-area-item-container-hover"),t.__elEditAreaItem.removeClass("tchmi-analytics-control-edit-area-item-hover"),t.removeEventListeners("editClose"),t.addOtherElementClickedEvent(t.__elTitleArea[0],t.__closeEditClicked(),"editClose")}}__closeEditClicked(){let t=this;return()=>{t.__elEdit.removeClass("tchmi-analytics-control-edit-active"),t.__elEditArea.removeClass("tchmi-analytics-control-edit-area-active"),t.__elEditAreaItemContainer.removeClass("tchmi-analytics-control-edit-area-item-container-hover"),t.__elEditAreaItem.removeClass("tchmi-analytics-control-edit-area-item-hover"),this.removeEventListeners("editClose")}}__onPropertiesClicked(){let e=this;return()=>{null!=this.__editableProperties&&(this.__beforeOpenPropertyWindow(),this.__openPropertyWindow(),setTimeout(()=>{t.TopMostLayer.add(this,e.__elProperties,{modal:!1,closeOnBackground:!1,dimBackground:!1}),e.__elDimMask.addClass("tchmi-analytics-control-dim-mask-active"),e.__elProperties.addClass("tchmi-analytics-control-properties-active")},10))}}__beforeOpenPropertyWindow(){}__onPropCloseClicked(){let e=this;return()=>{e.__elProperties.removeClass("tchmi-analytics-control-properties-active"),e.__elDimMask.removeClass("tchmi-analytics-control-dim-mask-active"),t.TopMostLayer.remove(this,e.__elProperties),e.__removePropWindowEventListeners()}}__onPropResetClicked(){let t=this;return()=>{for(let i=0;i<t.__editableProperties.length;++i){let s=t.__editableProperties[i];if(!s.allowReset)continue;let o=t.__secureId+s.name;const n=this.__parent instanceof e.LayoutManager?this.__parent.layoutIDWithoutDisplayMode:"";e.Utilities.deletePersistentData(o,e.StorageType.ServerExtension,n),e.Utilities.deletePersistentData(`AnalyticsKey_${o}`,e.StorageType.LocalStorage)}t.__originalPropertyValues.forEach((e,i,s)=>{e.modifiedValue=void 0,t["set"+i](tchmi_clone_object(e.originalValue))}),setTimeout(()=>{t.__openPropertyWindow()},200)}}__onWindowPropertyChanged(t,i,s,o){return function(){let n;if(i.type===e.E_DataType.BOOLEAN)n=t.checked;else{if(i.type===e.E_DataType.CHART_CHANNEL_CONFIG||i.type===e.E_DataType.TIME_INTERVAL||i.type===e.E_DataType.CHART_TIMERANGE_CONFIG)return;n=t.value}this.__setPropertyPersistent(i,n,s,o)}.bind(this)}__setPropertyPersistent(t,i,s,o){if(null==s)null!=this.__originalPropertyValues.get(t.name)&&(this.__originalPropertyValues.get(t.name).modifiedValue=i),this.__customPropSetting=!0,t.value=i,this.__customPropSetting=!1;else{const e=tchmi_clone_object(t.value);e[s][o]=i,this.__customPropSetting=!0,t.value=e,this.__customPropSetting=!1}let n=this.__secureId+t.name;if(t.type===e.E_DataType.CHART_CHANNEL_CONFIG||t.type===e.E_DataType.CHART_TIMERANGE_CONFIG||!t.allowPersist)return;const r=this.__parent instanceof e.LayoutManager?this.__parent.layoutIDWithoutDisplayMode:null;"object"!=typeof t.value?e.Utilities.setPersistentData(n,t.value.toString(),r):null!=t.value.color?e.Utilities.setPersistentData(n,e.Str.rgbaToHex(t.value.color),r):e.Utilities.setPersistentData(n,JSON.stringify(t.value),r)}__processCustomEdits(t=null){if(null!=this.__editableProperties)for(let i=0;i<this.__editableProperties.length;++i)try{let s=this.__editableProperties[i];if(null==s){this.Log("Cannot find Property to set. Property is skipped.");continue}if(!s.allowReset)continue;if(null!==t&&s.name!==t)continue;let o=this.__secureId+s.name,n=e.Utilities.getPersistentData(o);if(void 0===n){const t=this.__originalPropertyValues.get(s.name);null!=t&&(this.__customPropSetting=!0,s.setOriginalValue(t.originalValue),this.__customPropSetting=!1)}this.__originalPropertyValues.set(s.name,{originalValue:tchmi_clone_object(s.value),modifiedValue:n}),void 0!==n&&(this.__customPropSetting=!0,s.value=n,this.__customPropSetting=!1)}catch(t){this.Log(t,`Unexpected error while setting Property '${this.__editableProperties[i].name}' to persistent value. Property is skipped.`)}}__createEditArea(t){if(null===t||0===this.__elTitleArea.length)return void this.__elTitleArea.addClass("tchmi-analytics-control-title-area-empty");this.__showEditProperties||(t=this.__editAreaItems.filter(t=>"tchmi-analytics-edit-properties"!==t.className)),this.removeEventListeners("EditArea");for(let t=this.__elTitleArea[0].children.length-1;t>=0;--t){const e=this.__elTitleArea[0].children[t];(e.classList.contains("tchmi-analytics-control-arrow-icon")||e.classList.contains("tchmi-analytics-control-edit-area"))&&this.__elTitleArea[0].removeChild(e)}if(!this.__hasTitleArea||0===t.length)return void this.__elTitleArea.addClass("tchmi-analytics-control-title-area-empty");this.__elTitleArea.removeClass("tchmi-analytics-control-title-area-empty"),this.addEventListener(this.__elTitleArea[0],"mousedown",this.__onEditClicked(),!1,"EditArea"),this.addEventListener(this.__elTitleArea[0],"touchstart",this.__onEditClicked(),!1,"EditArea");const i=document.createElement("div");i.className="tchmi-analytics-control-arrow-icon tchmi-analytics-control-edit tchmi-analytics-svg-mask tchmi-box",i.style.backgroundColor=this.__fontColor,this.__elTitleArea[0].appendChild(i);const s=document.createElement("div");s.className="tchmi-analytics-control-edit-area";const o=new e.RootEditAreaItem(t);this.__createEditAreaItemsRecursive(o,s,null),this.__elTitleArea[0].appendChild(s),this.__elEdit=this.__elementTemplateRoot.find(".tchmi-analytics-control-edit"),this.__elEditArea=this.__elementTemplateRoot.find(".tchmi-analytics-control-edit-area"),this.__elEditAreaItem=this.__elementTemplateRoot.find(".tchmi-analytics-control-edit-area-item"),this.__elEditAreaItemContainer=this.__elementTemplateRoot.find(".tchmi-analytics-control-edit-area-item-container"),this.__elEditAreaEditProperties=this.__elementTemplateRoot.find(".tchmi-analytics-edit-properties"),this.__processEditPropertiesAlias(),this.__processFontsizeTitle()}__createEditAreaItemsRecursive(t,e,i){const s=null!==i,o=document.createElement("ul");o.className="tchmi-analytics-control-edit-area-list",s&&(o.className+=" tchmi-analytics-control-edit-area-list tchmi-analytics-control-edit-area-sublist");const n=t.subMembers.length;for(let e=0;e<n;++e){const i=t.subMembers[e],s=document.createElement("li");s.className="tchmi-analytics-control-edit-area-item";const r=document.createElement("div");r.className="tchmi-analytics-control-edit-area-item-container";const a=document.createElement("div");a.className="tchmi-analytics-control-edit-area-icon",a.style.backgroundImage=i.icon,i.iconClass&&(a.className+=` ${i.iconClass}`);const l=document.createElement("div");if(l.className=`tchmi-analytics-control-edit-area-text ${i.className}`,l.innerText=i.displayName,r.appendChild(a),r.appendChild(l),s.appendChild(r),this.addEventListener(r,"mousedown",this.__onEditAreaItemClicked(i),!0,"EditArea"),this.addEventListener(r,"touchstart",this.__onEditAreaItemClicked(i),!0,"EditArea"),e+1!==n){const t=document.createElement("div");t.className="tchmi-analytics-control-separator",s.appendChild(t)}i.subMembers.length>0&&this.__createEditAreaItemsRecursive(i,s,r),o.appendChild(s)}if(e.appendChild(o),s){const t='<svg class="tchmi-analytics-control-edit-area-menu-icon tchmi-analytics-control-text tchmi-box" viewBox="0 0 8 13" width="8px" height="13px"><path d="M2 2 L6 6 L2 10" stroke-width="1" stroke="currentColor" fill="none" />></svg>';i.insertAdjacentHTML("beforeend",t)}}__onEditAreaItemClicked(t){const e=this;let i=!0;return function(s){s.preventDefault(),s.stopPropagation(),s instanceof TouchEvent&&i&&(i=!1,$(this).toggleClass("tchmi-analytics-control-edit-area-item-container-hover"),$(this.parentElement).toggleClass("tchmi-analytics-control-edit-area-item-hover")),0===t.subMembers.length?i=!1:null==t.callback&&(i=!0),s instanceof TouchEvent&&!i&&e.__closeEditClicked()(),(s instanceof MouseEvent||!i)&&(i=!0,e.__preventEditAreaToggle=!0,null!=t.callback&&t.callback())}}__openPropertyWindow(){this.__elProperties=$(".tchmi-analytics-control-properties");let t=this.__elProperties.find(".tchmi-analytics-control-properties-container");if(0===this.__elProperties.length){const e=document.createElement("div");e.className="tchmi-analytics-control-properties",null!=this.__propertyWindowOptions.fontSize&&(e.style.fontSize=this.__propertyWindowOptions.fontSize),null!=this.__propertyWindowOptions.backgroundColor&&(e.style.backgroundColor=this.__propertyWindowOptions.backgroundColor),null!=this.__propertyWindowOptions.foregroundColor&&(e.style.color=this.__propertyWindowOptions.foregroundColor);const i=document.createElement("div");i.className="tchmi-analytics-control-dim-mask",this.addPropWindowEventListener(i,"click",this.__onPropCloseClicked());const s=document.createElement("div");s.className="tchmi-analytics-control-property tchmi-analytics-control-property-identifier";const o=document.createElement("div");o.className="tchmi-analytics-control-property-name",o.innerText="Identifier";const n=document.createElement("div");n.className="tchmi-analytics-control-value tchmi-analytics-control-id-value",n.innerText=this.__id,n.title=this.__id;const r=document.createElement("div");r.className="tchmi-analytics-control-close-hover",s.appendChild(o),s.appendChild(n),s.insertAdjacentHTML("beforeend",this.__htmlCodeCloseIcon),s.appendChild(r);const a=s.getElementsByClassName("tchmi-analytics-control-close")[0];this.addPropWindowEventListener(a,"click",this.__onPropCloseClicked()),t[0]=document.createElement("div"),t[0].className="tchmi-analytics-control-properties-container";const l=document.createElement("div");if(l.className="tchmi-analytics-control-reset-properties",l.title="Reset of properties to default.",this.addPropWindowEventListener(l,"mousedown",this.__onPropResetClicked()),e.appendChild(l),document.querySelectorAll(".tchmi-analytics-control-dim-mask").forEach(t=>t.remove()),document.body.appendChild(i),document.body.appendChild(e),this.__elProperties=$(".tchmi-analytics-control-properties"),this.__elDimMask=$(".tchmi-analytics-control-dim-mask"),this.__elProperties[0].appendChild(s),null!=this.__propertyWindowOptions.heading){const e=document.createElement("div");e.className="tchmi-analytics-control-property tchmi-analytics-control-property-editable",e.className="tchmi-analytics-control-content-separator",e.innerHTML=this.__propertyWindowOptions.heading,t[0].appendChild(e)}e.appendChild(t[0])}else{this.__elDimMask=$(".tchmi-analytics-control-dim-mask");const e=this.__elDimMask[0],i=this.__elProperties.find(".tchmi-analytics-control-close")[0],s=this.__elProperties.find(".tchmi-analytics-control-reset-properties")[0];this.addPropWindowEventListener(e,"click",this.__onPropCloseClicked()),this.addPropWindowEventListener(i,"click",this.__onPropCloseClicked()),this.addPropWindowEventListener(s,"mousedown",this.__onPropResetClicked()),this.__elProperties.find(".tchmi-analytics-control-property-editable").each((e,i)=>{t[0].removeChild(i)}),this.__elProperties.find(".tchmi-analytics-control-id-value").html(this.__id)}for(let i=0;i<this.__editableProperties.length;++i)try{const s=this.__editableProperties[i];null==s&&this.Log("Cannot find Property to load.");const o=document.createElement("div");o.className="tchmi-analytics-control-property tchmi-analytics-control-property-editable",o.title=null!=s.tooltip?s.tooltip:s.displayName;const n=document.createElement("div");if(n.className="tchmi-analytics-control-property-name",n.innerText=s.displayName,null==s.subName){const e=this.__propertyHandling(s,n);this.addPropWindowEventListener(e,"input",this.__onWindowPropertyChanged(e,s)),this.__elProperties.data("controlID",this.__id),o.appendChild(n),o.appendChild(e),t[0].appendChild(o)}else{o.appendChild(n),o.style.fontStyle="italic",t[0].appendChild(o);for(let i=0;i<s.value.length;++i){const o=document.createElement("div");o.className="tchmi-analytics-control-property tchmi-analytics-control-sub-property tchmi-analytics-control-property-editable";const n=document.createElement("div");let r;switch(n.className="tchmi-analytics-control-property-name",n.innerText=`${s.subDisplayName} ${i+1}`,s.type){case e.E_DataType.STRING:r=document.createElement("input"),r.className="tchmi-analytics-control-value",r.value=s.getSubValue(i)}this.addPropWindowEventListener(r,"change",this.__onWindowPropertyChanged(r,s,i,s.subName)),o.appendChild(n),o.appendChild(r),t[0].appendChild(o),s.shifted&&this.__elProperties.addClass("tchmi-analytics-control-sub-property")}}}catch(t){this.Log(t,`Unexpected exception while loading Property '${this.__editableProperties[i].name}' into Property window. Property is skipped.`)}screen.width<350?(this.__elProperties.addClass("tchmi-analytics-control-properties-mobile"),this.__elProperties.find(".tchmi-analytics-control-property-name").addClass("tchmi-analytics-control-property-name-mobile")):(this.__elProperties.removeClass("tchmi-analytics-control-properties-mobile"),this.__elProperties.find(".tchmi-analytics-control-property-name").removeClass("tchmi-analytics-control-property-name-mobile"))}__propertyHandling(i,s){var o;let n;switch(i.type){case e.E_DataType.STRING:n=document.createElement("input"),n.className="tchmi-analytics-control-value",n.value=i.value,this.__checkDisableInputElement(n,i);break;case e.E_DataType.NUMBER:case e.E_DataType.UINTEGER:case e.E_DataType.INTEGER:const r=document.createElement("input");n=r,n.className="tchmi-analytics-control-value",n.setAttribute("type","text"),n.setAttribute("data-tchmi-input-mode","numeric"),n.value=i.value,i.type==e.E_DataType.UINTEGER&&n.setAttribute("data-tchmikeyboard-min","0");let a=i.value;this.addPropWindowEventListener(n,"input",()=>{const t=r.value;this.__isValidNumber(t,i.type)?a=t:r.value=a}),this.__checkDisableInputElement(n,i);break;case e.E_DataType.BOOLEAN:n=document.createElement("input"),n.className="tchmi-analytics-control-value",n.setAttribute("type","checkbox"),n.checked=i.value,this.__checkDisableInputElement(n,i);break;case e.E_DataType.COMBOBOX:n=document.createElement("select"),n.className="tchmi-analytics-control-value",n.style.width="200px";for(let t=0;t<i.options.length;++t){let e=document.createElement("option");e.value=i.options[t].value,e.innerText=i.options[t].displayName,n.appendChild(e)}n.value=i.value,this.__checkDisableInputElement(n,i);break;case e.E_DataType.MAX_COMBOBOX:let l=t.ValueConverter.toObject(i.options[0].value);n=document.createElement("div"),n.className="tchmi-analytics-custom-dropdown";const c=document.createElement("div");c.className="tchmi-analytics-options",n.appendChild(c);const _=document.createElement("div");_.className="tchmi-analytics-selected-option",n.appendChild(_),l.forEach(t=>{const e=document.createElement("div");e.className="tchmi-analytics-option",e.innerHTML=`\n                                            <img src="${t.imgSrc}" alt="Picture" class="tchmi-analytics-option-image">\n                                            <div class="tchmi-analytics-option-text-container">\n                                              <strong class="tchmi-analytics-option-bold">${t.boldText}</strong>\n                                              <p class="tchmi-analytics-option-normal">${t.normalText}</p>\n                                            </div>\n                                          `,c.appendChild(e),e.addEventListener("click",()=>{_.className="tchmi-analytics-selected-value",_.innerHTML=`\n                                                <img src="${t.imgSrc}" alt="Picture" class="tchmi-analytics-selected-value-image">\n                                                <div class="tchmi-analytics-text-container">\n                                                  <strong class="tchmi-analytics-angle-bold">${t.boldText}</strong>\n                                                </div>\n                                                <div class="tchmi-analytics-selected-value-angle ">\n                                                    <strong class="tchmi-analytics-angle-bold">&gt;</strong>\n                                                </div>\n                                                `,c.style.display="none",i.value=t.value})}),n.addEventListener("click",t=>{[...t.target.classList].some(t=>t.includes("option"))||(c.style.display="block"===c.style.display?"none":"block")}),c.addEventListener("mouseleave",()=>{c.style.display="none"});const h=l.find(t=>t.value==i.value);h&&(_.className="tchmi-analytics-selected-value",_.innerHTML=`\n                                                <img src="${h.imgSrc}" alt="Picture" class="tchmi-analytics-selected-value-image">\n                                                <div class="tchmi-analytics-text-container">\n                                                  <strong class="tchmi-analytics-angle-bold">${h.boldText}</strong>\n                                                </div>\n                                                <div class="tchmi-analytics-selected-value-angle ">\n                                                    <strong class="tchmi-analytics-angle-bold">&gt;</strong>\n                                                </div>\n                                                `,c.style.display="none"),s.className="";break;case e.E_DataType.SOLIDCOLOR:n=document.createElement("input"),n.type="color",n.value=this.rgbaToHex(i.value.color),this.__checkDisableInputElement(n,i);break;case e.E_DataType.DATETIME:n=document.createElement("div"),n.className="tchmi-analytics-control-value",n.value=i.value;let d=document.createElement("input");d.type="date",d.className="tchmi-analytics-control-date";let m=document.createElement("input");m.type="time",m.step="0.001",m.className="tchmi-analytics-control-time",n.appendChild(d),n.appendChild(m),this.__checkDisableInputElement(d,i),this.__checkDisableInputElement(m,i);break;case e.E_DataType.TIME:n=document.createElement("button"),n.className="tchmi-analytics-control-value",n.style.width="177px",n.style.height="20px",n.innerHTML=i.options[0].displayName,n.value=i.options[0].value,n.addEventListener("click",this.__onWindowPropertyChanged(n,i)),this.__checkDisableInputElement(n,i);break;case e.E_DataType.TIME_INTERVAL:n=document.createElement("div"),n.style.maxWidth="calc(100% - 152px)";const p=document.createElement("input");p.type="number",p.style.width="30%",p.style.marginRight="5%",n.appendChild(p);let u=Object.keys(e.TimeIntervalStrings).map(t=>({value:e.TimeIntervalStrings[t],displayName:e.TimeIntervalStrings[t]}));null!=i.options&&i.options.length>0&&(u=i.options);const g=document.createElement("select");u.forEach(t=>{const e=document.createElement("option");e.text=t.displayName,e.value=t.value,g.add(e)}),n.appendChild(g),g.style.width="129px",g.style.width="60%";i.value;const y=i.value;p.value=(null!==(o=null==y?void 0:y.rangeValue)&&void 0!==o?o:1).toString(),g.selectedIndex=u.indexOf(u.find(t=>t.value==y.rangeUnit)),i.canBeSet?(this.addEventListener(p,"change",()=>this.__changeTimeIntervalProperty(i,p,g)),this.addEventListener(g,"change",()=>this.__changeTimeIntervalProperty(i,p,g))):(p.disabled=!0,p.title=i.disabledTooltip,g.disabled=!0,g.title=i.disabledTooltip),document.body.appendChild(n),this.__checkDisableInputElement(p,i),this.__checkDisableInputElement(g,i);break;case e.E_DataType.CONTENTSEPARATOR:s.className="tchmi-analytics-control-content-separator",s.innerHTML="";const C=document.createElement("div");if(C.className="tchmi-analytics-control-content-separator-text",C.innerHTML=i.options[0].displayName,s.appendChild(C),null!=i.contentSeparatorAddCallback){const t=document.createElement("button");t.className="tchmi-analytics-control-content-separator-tchmi-analytics-control-add-item-placeholder",t.textContent="+",t.title="Add new item.",s.appendChild(t),this.__eventListenerManager.addEventListener(t,"click",i.contentSeparatorAddCallback,!0,"EditAreaContentSeparator")}n=document.createElement("div"),this.__checkDisableInputElement(n,i)}return n}__isValidNumber(t,i){switch(i){case e.E_DataType.UINTEGER:return/^\d+$/.test(t);case e.E_DataType.INTEGER:return/^-?\d+$/.test(t);case e.E_DataType.NUMBER:return!isNaN(Number(t));default:return!1}}__checkDisableInputElement(t,e){!e.canBeSet&&(t instanceof HTMLInputElement||t instanceof HTMLSelectElement)&&(t.disabled=!0,t.title=e.disabledTooltip||"This property cannot be set.")}__changeTimeIntervalProperty(e,i,s){const o={rangeValue:t.ValueConverter.toNumber(i.value),rangeUnit:s.value};e.value=o}dropNameAlias(){if(this.__parent instanceof e.LayoutManager){const t=this.__parent.layoutIDWithoutDisplayMode.toString();e.Utilities.__dropPersistentDataInSerExt(`${this.__id}NameAlias`,t)}e.Utilities.deletePersistentData(`AnalyticsKey_${this.__id}NameAlias`,e.StorageType.LocalStorage)}resetProperties(){this.__onPropResetClicked()()}__createPopup(t,e=CustomElements.PopupStatus.INFO,i=1e4,s=!1,o=""){this.__showPopupMessages&&CustomElements.PopupManager.createPopup(t,e,i,s,o)}}e.AnalyticsControl=i}(i=e.Analytics||(e.Analytics={})),t.Controls.registerEx("AnalyticsControl","TcHmi.Controls.Analytics",i.AnalyticsControl)}(e=t.Controls||(t.Controls={}))}(TcHmi||(TcHmi={})),TCHMI_DESIGNER&&(CustomElements.PopupManager.instance.disabled=!0),TcHmi.Controls.Analytics.Utilities.clearPersistentData();