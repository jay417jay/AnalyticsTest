var TcHmi;!function(t){!function(e){!function(e){class l extends e.LayoutGenerator{constructor(t,e){super(t,e),this.hasDisplaySizeChanged=!1,this.ctrlPositioner=new i(t,e)}createLayout(){this.ctrlPositioner.initalizationHelperLayout=[],this.__prepareLayout();try{this.__positionLaptopCtrls()}catch(t){console.error(`Positioning of Controls on the Grid failed: ${t}`)}}__positionLaptopCtrls(){this.__layoutProps.layoutInitialized||this.__sortGridElements();let t=[];for(let e=0;e<this.__layoutProps.ElElementTemplateRoot.children().length;e++){let l,i;if([l,i]=this.__getGridElements(l,i,e),"grid-buffer-cell-id"===l.id)continue;let o=this.__getStoredCtrlDim(i);null!=o||(o=this.__positionDesktopCtrl(i,l,e),null!=o)?(this.__layoutProps.layoutInitialized?this.__setCtrlStyle(i):this.__convertCtrlToGridEl(i,l,e),this.__layout.setGridElStyle(l,o),this.ctrlPositioner.initalizationHelperLayout.push(o)):(this.__layoutProps.ElElementTemplateRoot[0].contains(i)&&(this.__layoutProps.ElElementTemplateRoot[0].removeChild(l),this.__layoutProps.ElElementTemplateRoot[0].appendChild(l)),t.push(l))}this.__finishLayoutGeneration(t)}__sortGridElements(){let t=[];for(let e=0;e<this.__layoutProps.ElElementTemplateRoot.children().length;e++)t.push(this.__layoutProps.ElElementTemplateRoot.children()[e]),this.__layoutProps.ElElementTemplateRoot[0].removeChild(this.__layoutProps.ElElementTemplateRoot.children()[e]),e--;this.__layoutProps.defaultCtrlPosition.sort((t,e)=>t.top===e.top?t.left<e.left?-1:1:t.top<e.top?-1:1);for(let e=0;e<this.__layoutProps.defaultCtrlPosition.length;e++){let l=t.find(t=>`${t.id}_GridElement`==this.__layoutProps.defaultCtrlPosition[e].id);null!=l&&(this.__layoutProps.ElElementTemplateRoot[0].appendChild(l),t.splice(t.indexOf(l),1))}for(const e of t)this.__layoutProps.ElElementTemplateRoot[0].appendChild(e)}__positionDesktopCtrl(t,e,l){let i;return i=0===l&&this.__layoutProps.mobileLayoutInitialized||this.__layoutProps.isLayoutReset||this.hasDisplaySizeChanged?this.ctrlPositioner.positionCtrl(t,e,!1):this.ctrlPositioner.positionCtrl(t,e,!0),i}__finishLayoutGeneration(t){if(t.length>0&&this.__remainingCtrlHandling(t),null==this.__layoutProps.sortingType||this.__layoutProps.isUserSpecificLayout||this.__checkForEmptyRows(),this.__layout.calcCurrentLayout(),""==this.generatedLayout&&""==this.editedLayout){let t=this.__layout.getCurrentLayout();""==this.__layoutProps.requestedLayout&&t.length>1&&(t[t.length-1].vis=!0),this.generatedLayout=JSON.stringify(t)}}__remainingCtrlHandling(t){this.__layout.changeRowNumber(2);for(let e=0;e<t.length;e++){let l;this.__layoutProps.layoutInitialized?l=t[e]:(l=document.createElement("div"),l.className="tchmi-layout-manager-grid-cell",this.__convertCtrlToGridEl(t[e],l,e,!0));let i={cS:1,cE:3};i.rS=this.__layoutProps.numberOfRows-2,i.rE=this.__layoutProps.numberOfRows,i.id=t[e].id,i.vis=!0,i=this.ctrlPositioner.checkOldCtrlPosition(i),this.__layout.setGridElStyle(l,i),this.ctrlPositioner.initalizationHelperLayout.push(i)}}__checkForEmptyRows(){let t=this.ctrlPositioner.initalizationHelperLayout,e=this.__layout.getNumberOfRows(t),l=new Array(e).fill(!1);for(let e=0;e<t.length;e++)for(let i=t[e].rS;i<t[e].rE;i++)l[i-1]=!0;t.sort((t,e)=>t.rS-e.rS);let i=0;for(let e=0;e<l.length-1;e++)if(0==l[e]){for(let l=0;l<t.length;l++)t[l].rS>e&&(t[l].rS--,t[l].rE--);i++,l.splice(e,1),e--}for(let e=0;e<t.length;e++){let l=this.__layoutProps.ElCtrlElement.find(`#${t[e].id.replace("_GridElement","")}_GridElement`)[0],i=t[e];null!=l&&this.__layout.setElementGridDimensions(l,i)}this.__layout.changeRowNumber(-i)}addControl(t,e=null){let l=t.getElement()[0],i=document.createElement("div");i.className="tchmi-layout-manager-grid-cell",null==e&&(e=this.ctrlPositioner.calculateCtrlPosition(l,""),(e=this.ctrlPositioner.checkOldCtrlPosition(e)).vis=!0),this.__convertCtrlToGridEl(l,i,0,!1,!1),this.__setCtrlStyle(l),this.__layout.setGridElStyle(i,e),this.__layout.calcCurrentLayout()}}e.DesktopLayoutGenerator=l;class i extends e.LayoutElement{constructor(t,e){super(t,e),this.originalHeight=0,this.initalizationHelperLayout=[]}positionCtrl(t,e,l,i=!1){let o;if(this.__layoutProps.layoutInitialized||i){if(null==this.__layoutProps.defaultCtrlStyle[e.id])return null;o=this.calculateCtrlPosition(t,this.__layoutProps.defaultCtrlStyle[e.id])}else o=this.calculateCtrlPosition(t,"");return l&&(o=this.checkOldCtrlPosition(o)),o.vis=!0,o}calculateCtrlPosition(t,e){const l=this.__getCtrlStyle(t,e),i=this.__getCtrlPosition(l);let o={};o.rS=Math.ceil(i.top/this.__layoutProps.rowHeightPx),o.cS=Math.ceil(i.left/this.__layoutProps.columnWidthPx);let r=Math.ceil(.8*i.width/(this.__layoutProps.columnWidthPx+this.__layoutProps.gridGapPx)),s=Math.ceil(.8*i.height/(this.__layoutProps.rowHeightPx+this.__layoutProps.gridGapPx));r%2==1&&r++,s%2==1&&s>3&&s++,o.cS<=0&&(r=r+o.cS-1>=1?r+o.cS-1:2,o.cS=1),o.rS<=0&&(s=s+o.rS-1>=1?s+o.rS-1:2,o.rS=1);let n=r;return o.cS+r>this.__layoutProps.numberOfColumns+1&&(o.cS>=this.__layoutProps.numberOfColumns&&(o.cS=this.__layoutProps.numberOfColumns-1),r=this.__layoutProps.numberOfColumns-o.cS),this.__layoutProps.isEditing?o.rS+s>=this.__layoutProps.numberOfRows&&this.__layout.changeRowNumber(o.rS+s-this.__layoutProps.numberOfRows):o.rS+s-1>=this.__layoutProps.numberOfRows&&this.__layout.changeRowNumber(o.rS+s-1-this.__layoutProps.numberOfRows),o.rE=o.rS+s,o.cE=o.cS+r,o.id=t.id,n!=r&&o.cS+n<=this.__layoutProps.numberOfColumns+1&&(o.cE=o.cS+n),o}__getCtrlStyle(t,e){let l;if(""==e){let e=t.getAttribute("style");l=null==e?{}:e.split("; ")}else l=e.split("; ");let i={};for(let t=0;t<l.length;t++){let e=l[t].split(": ");i[e[0]]=e[1]}return i}__getCtrlPosition(e){let l=0,i=0;null!=this.__layoutProps.defaultVPWidth&&null!=this.__layoutProps.defaultVPHeight?(l="%"==this.__layoutProps.widthUnit?this.__layoutProps.defaultVPWidth*this.__layoutProps.width/100:this.__layoutProps.width,i=0!=this.originalHeight?this.__layoutProps.defaultVPHeight*this.originalHeight/100:this.__layoutProps.height):(l=this.__layoutProps.ElCtrlElement[0].clientWidth,i=this.__layoutProps.defaultContainerHeight,0===i&&(i=this.__layoutProps.ElCtrlElement[0].clientHeight));let o=0;-1==e.width.indexOf("%")?o=Number.parseFloat(e.width):(o=Number.parseFloat(e.width),o=o/100*l);let r=0;-1==e.height.indexOf("%")?r=Number.parseFloat(e.height):(r=Number.parseFloat(e.height),r=r/100*i);let s=0;if(null!=e.top)-1==e.top.indexOf("%")?s=Number.parseFloat(e.top):(s=Number.parseFloat(e.top),s=s/100*i);else{let t=0;-1==e.bottom.indexOf("%")?s=i-Number.parseFloat(e.bottom):(t=Number.parseFloat(e.bottom),s=i-t)}let n=0;if(null!=e.left)-1==e.left.indexOf("%")?n=t.ValueConverter.toNumber(e.left.split("px")[0]):(n=t.ValueConverter.toNumber(e.left.split("%")[0]),n=n/100*l);else{let i=0;-1==e.right.indexOf("%")?n=l-t.ValueConverter.toNumber(e.right.split("px")[0]):(i=t.ValueConverter.toNumber(e.right.split("%")[0]),i=i/100*l,n=l-i)}let a={};return a.left=n,a.top=s,a.width=o,a.height=r,a}checkOldCtrlPosition(t){const e=t.cS,l=t.cE,i=this.__getInitalisingLayout();if(!this.__layout.checkCtrlPosition(t,i,!1))for(;!this.__layout.checkCtrlPosition(t,i,!1);)t.cE<this.__layoutProps.numberOfColumns+1?(t.cS++,t.cE++):(t.cS=e,t.cE=l,t.rS++,t.rE++,t.rE>this.__layoutProps.numberOfRows&&this.__layout.changeRowNumber(t.rE-this.__layoutProps.numberOfRows));return t}__getInitalisingLayout(){let t=this.__layout.getCurrentLayout();for(let e=0;e<t.length;e++)t[e].id.includes("_GridElement")||(t.splice(e,1),e--);return t}}e.DesktopCtrlPositioner=i}(e.Analytics||(e.Analytics={}))}(t.Controls||(t.Controls={}))}(TcHmi||(TcHmi={}));