var TcHmi;!function(t){!function(e){!function(e){class i extends e.ChartElement{constructor(e,i,n,s,a,h,l,_){super(i,n,_),this.__symbols=[],this.__eventlistenerManager=new t.Controls.Analytics.EventListenerManager,this.__elTimestampTexts=[],this.__elChannelColorRects=[],this.__elChannelNames=[],this.__elChannelValues=[],this.__margin=10,this.__symbols=e,this.__startPoint=s,this.__endPoint=a,this.__chart=h,this.__drawLine=l}updateStartEndPoint(t,e){this.__startPoint=t,this.__endPoint=e,this.__options.useHoverEffect||this.disableHoverEffect()}enableHoverEffect(){const t=this.elParent;this.__eventlistenerManager.addEventListener(t,"mousemove",this.__updateLastKnownPos()),this.__eventlistenerManager.addEventListener(t,"mouseleave",this.__processHoverEffectEnd())}disableHoverEffect(){this.__eventlistenerManager.removeEventListeners()}__processHoverEffectEnd(){return t=>{this.__chart.processOnHoverEnd(),this.cleanElement(),this.__isHovering=!1}}__updateLastKnownPos(){return t=>{this.__isHovering=!0;const i=this.elParent.getBoundingClientRect(),n=t.clientX-i.left-this.__props.defaultAxisMargin/2,s=t.clientY-i.top-this.__props.defaultAxisMargin/2;n<0||n+this.__startPoint.x>this.__endPoint.x||s<0||s+this.__startPoint.y>this.__endPoint.y||(this.__lastKnownPos=new e.Point(n,s),this.drawHoverWindow(this.__lastKnownPos.x,this.__lastKnownPos.y))}}drawHoverWindow(i,n,s){var a;if(!this.__isHovering&&!s)return;i=i||this.__lastKnownPos.x,i+=this.__startPoint.x,n=n||this.__lastKnownPos.y,n+=this.__startPoint.y;this.__drawLine?null!=this.__elHoverLine?this.__elHoverLine.updatePosition(i,this.__startPoint.y,i,this.__endPoint.y):(this.__elHoverLine=new e.SVGLine(i,this.__startPoint.y,i,this.__endPoint.y,["tchmi-analytics-charting-hover-line"]),this.__props.darkMode&&this.__elHoverLine.classList.add("tchmi-analytics-charting-hover-line-dark"),this.__elHoverLine.appendTo(this.elParent)):this.__elHoverLine&&(this.__elHoverLine.removeFromParent(),this.__elHoverLine=null);const h=this.__chart.processOnHover(i,n);if(null==h||0==h.length)return void this.cleanElement();if(null==this.__hoverMainDiv){this.__hoverMainDiv=document.createElement("div"),this.__hoverMainDiv.classList.add("tchmi-analytics-charting-hover-window-parent-div");const e={modal:!1,closeOnBackground:!1,dimBackground:!1};t.TopMostLayer.add(this.__props.chartCtrl,$(this.__hoverMainDiv),e)}null==this.__hoverMainSvg&&(this.__hoverMainSvg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.__hoverMainSvg.classList.add("tchmi-analytics-charting-hover-window-parent-svg"),this.__props.darkMode&&this.__hoverMainSvg.classList.add("tchmi-analytics-charting-hover-window-parent-svg-dark"),this.__hoverMainDiv.appendChild(this.__hoverMainSvg)),null==this.__elMainWindow&&(this.__elMainWindow=new e.SVGRectangle(0,0,0,0,["tchmi-analytics-charting-hover-window"]),this.__hoverMainSvg.appendChild(this.__elMainWindow.elGroup)),this.__elMainWindow.updateDarkMode(this.__props.darkMode);let l=null,_=-1;for(let t=0;t<h.length;t++){const i=h[t];if(i.channelValues.length>0){const n=l?l.y+l.height+this.__margin:10+2*this.__margin,s=null!=i.timestamp?this.__getTimestampText(new e.SPTime(i.timestamp)):"";let a;(a=this.__elTimestampTexts[t])?(a.textContent=s,a.updatePosition(10+this.__margin,n)):(a=new e.SVGText(10+this.__margin,n,s,["tchmi-analytics-charting-hover-header","tchmi-analytics-text"]),a.appendTo(this.__elMainWindow.elGroup),this.__elTimestampTexts.push(a)),this.__props.darkMode?a.addClass("tchmi-analytics-svg-text-dark"):a.removeClass("tchmi-analytics-svg-text-dark"),l=a;for(let t=0;t<i.channelValues.length;t++){_++;const n=i.channelValues[t],s=10;let a,h;(a=this.__elChannelColorRects[_])?a.updatePosition(10+this.__margin,l.y+l.height-s+this.__margin):(a=new e.SVGRectangle(10+this.__margin,l.y+l.height-s+this.__margin,s,s,["tchmi-analytics-charting-hover-rect"]),a.appendTo(this.__elMainWindow.elGroup),this.__elChannelColorRects.push(a)),a.fill=n.channelColor;const o=a.x+a.height+this.__margin,r=l.y+l.height+this.__margin;let c;(h=this.__elChannelNames[_])?(h.updatePosition(o,r),h.updateContent(n.symbolName)):(h=new e.SVGText(o,r,n.symbolName,["tchmi-analytics-charting-hover-symbolname","tchmi-analytics-text"]),h.appendTo(this.__elMainWindow.elGroup),this.__elChannelNames.push(h));const d=l.y+l.height+this.__margin;(c=this.__elChannelValues[_])?(c.textContent=n.displayValue,c.updatePosition(h.x+h.width,d)):(c=new e.SVGText(h.x+h.width,d,n.displayValue,["tchmi-analytics-charting-hover-value","tchmi-analytics-text"]),c.appendTo(this.__elMainWindow.elGroup),this.__elChannelValues.push(c)),null!=n.unscaledValue&&(c.textContent+=` (${n.unscaledValue})`),n.unit&&(c.textContent+=` ${n.unit}`),this.__props.darkMode?(h.addClass("tchmi-analytics-svg-text-dark"),c.addClass("tchmi-analytics-svg-text-dark")):(h.removeClass("tchmi-analytics-svg-text-dark"),c.removeClass("tchmi-analytics-svg-text-dark")),n.highlight?(h.addClass("tchmi-analytics-charting-hover-text-underlined"),c.addClass("tchmi-analytics-charting-hover-text-underlined")):(h.removeClass("tchmi-analytics-charting-hover-text-underlined"),c.removeClass("tchmi-analytics-charting-hover-text-underlined")),l=c}let h=Math.max(...this.__elChannelNames.map(t=>t.x+t.width))+this.__margin,o=Math.max(...this.__elTimestampTexts.map(t=>t.x+t.width))+this.__margin;o>h&&(h=o);for(const t of this.__elChannelValues)t.x=h}}const o=this.__elTimestampTexts.length-h.length;let r=0;for(let t=0;t<o;t++){this.__elTimestampTexts[this.__elTimestampTexts.length-1-t].removeFromParent();for(let t=0;t<(null===(a=h[0])||void 0===a?void 0:a.channelValues.length);t++)this.__elChannelValues[this.__elChannelValues.length-1-r].removeFromParent(),this.__elChannelNames[this.__elChannelNames.length-1-r].removeFromParent(),this.__elChannelColorRects[this.__elChannelColorRects.length-1-r].removeFromParent(),r++}this.__elTimestampTexts.splice(h.length,o),this.__elChannelValues.splice(this.__elChannelValues.length-r,r),this.__elChannelNames.splice(this.__elChannelNames.length-r,r),this.__elChannelColorRects.splice(this.__elChannelColorRects.length-r,r);const c=Math.max(...this.__elChannelValues.map(t=>t.x));this.__elChannelValues.forEach(t=>{t.x=c});const d=Math.max(...this.__elChannelValues.map(t=>t.width));if(this.__elChannelValues.forEach(t=>{t.x+=d-t.width}),null==l)return;const m=l.x+l.width+this.__margin-this.__elMainWindow.x,v=l.y+l.height+this.__margin-this.__elMainWindow.y;this.__elMainWindow.width=m,this.__elMainWindow.height=v,this.__hoverMainSvg.style.width=`${l.x+l.width+this.__margin-this.__elMainWindow.x}px`,this.__hoverMainSvg.style.height=`${l.y+l.height+this.__margin-this.__elMainWindow.y}px`;const g=this.elParent.getBoundingClientRect().x-this.__startPoint.x+i+15,p=this.elParent.getBoundingClientRect().y-this.__startPoint.y+n+15;this.__hoverMainDiv.style.left=`${g}px`,this.__hoverMainDiv.style.top=`${p}px`,g+m>window.innerWidth&&g-m>0&&(this.__hoverMainDiv.style.left=`${g-m}px`),p+v>window.innerWidth&&p-v>0&&(this.__hoverMainDiv.style.left=`${p-v}px`)}cleanElement(){var i,n,s;this.__eventlistenerManager.removeEventListeners("windowScrolling"),t.TopMostLayer.remove(this.__props.chartCtrl,$(this.__hoverMainDiv)),null===(i=this.__elHoverLine)||void 0===i||i.removeFromParent(),this.__elHoverLine=void 0,null===(n=this.__elMainWindow)||void 0===n||n.removeFromParent(),this.__elMainWindow=void 0,this.__hoverMainDiv=void 0,this.__hoverMainSvg=void 0,this.__elTimestampTexts.forEach(t=>t.removeFromParent()),this.__elTimestampTexts=[],this.__elChannelColorRects.forEach(t=>t.removeFromParent()),this.__elChannelColorRects=[],this.__elChannelNames.forEach(t=>t.removeFromParent()),this.__elChannelNames=[],this.__elChannelValues.forEach(t=>t.removeFromParent()),this.__elChannelValues=[],this.__chart instanceof e.GridBasedChart&&(null===(s=this.__chart)||void 0===s||s.clearHoverPoints())}__getTimestampText(t){return`${this.__props.localizationReader.get(t.dayInText)}, ${this.__props.localizationReader.get(t.monthInText)} ${t.day.toLocaleString("en",{minimumIntegerDigits:2})}, ${t.year}: ${t.hours.toLocaleString("en",{minimumIntegerDigits:2})}:${t.minutes.toLocaleString("en",{minimumIntegerDigits:2})}:${t.seconds.toLocaleString("en",{minimumIntegerDigits:2})}:${t.milliseconds.toLocaleString("en",{minimumIntegerDigits:3})}`}}e.HoverWindow=i}(e.Analytics||(e.Analytics={}))}(t.Controls||(t.Controls={}))}(TcHmi||(TcHmi={}));