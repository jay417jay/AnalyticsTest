var TcHmi;!function(t){let e;!function(e){let i;!function(e){class i extends t.Controls.Analytics.AnalyticsControl{constructor(t,e,i){super(t,e,i),this.__radialGrad="radiaGradientIntegrator",this.__oldMaxValue=5,this.__oldMinValue=0,this.__firstRun=!0,this.__resetAxisLabelsEvent=null,this.__onResized=()=>(t,e)=>{let i=super.__getScaleFactor();0!=this.__hasLicense&&(this.__showReset?this.__elementNameAlias.css("padding-right","16px"):this.__elementNameAlias.css("padding-right","5px"),this.__elementChart.css("width",450*i),this.__elementChart.css("height",270*i),this.__elementChart.css("margin",5*i),this.__elementChart.css("padding-top",5*i))},this.getMinDataYValue=function(t){let e=t[0];for(var i=1;i<t.length;i++)t[i]<e&&(e=t[i]);return!0===t.nullAxis&&e>0&&(e=0),e},this.drawHorizontalLine=function(t,e,i,s){var r=document.createElementNS("http://www.w3.org/2000/svg","line");return r.classList.add(s),r.setAttribute("x1",t+"px"),r.setAttribute("y1",e+"px"),r.setAttribute("x2",i+"px"),r.setAttribute("y2",e+"px"),r},this.drawPoint=function(t,e,i,s){var r=document.createElementNS("http://www.w3.org/2000/svg","circle");return r.classList.add(s),r.setAttribute("cx",t+"px"),r.setAttribute("cy",e+"px"),r.setAttribute("r",i+"px"),r}}__previnit(){super.__previnit(),0!=this.__hasLicense&&(this.__defaultWidth=470,this.__defaultHeight=310,this.__dataPointsY=[],this.__elementChart=this.__elementTemplateRoot.find(".tchmi-integrator-svg"),this.__elementChartDefs=this.__elementTemplateRoot.find(".tchmi-integrator-defs-chart"),this.__elementChartCoordSystem=this.__elementTemplateRoot.find(".tchmi-integrator-coordinate-system"),this.__elementChartCoordSystemText=this.__elementTemplateRoot.find(".tchmi-integrator-coordinate-system-text"),this.__elementChartYAxisLabel=this.__elementTemplateRoot.find(".tchmi-integrator-y-axis-label-text"),this.__elementChartYLines=this.__elementTemplateRoot.find(".tchmi-integrator-lines"),this.__elementChartYPoints=this.__elementTemplateRoot.find(".tchmi-integrator-graph-points"),this.__elementChartGraphLine=this.__elementTemplateRoot.find(".tchmi-integrator-line-graph"))}__init(){super.setEditableProperties([]),super.__init()}__attach(){super.__attach()}__detach(){super.__detach()}destroy(){this.__keepAlive||super.destroy()}setYValue(e){var i=t.ValueConverter.toNumber(e);null===i&&(i=this.getAttributeDefaultValueInternal("YValue")),i!==this.__yValue&&(this.__yValue=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getYValue"]),this.__processYValue())}getYValue(){return this.__yValue}__processYValue(){this.__processInputData()}setValueSize(e){var i=t.ValueConverter.toNumber(e);null===i&&(i=this.getAttributeDefaultValueInternal("ValueSize")),JSON.stringify(i)!==JSON.stringify(this.__valueSize)&&(this.__valueSize=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getValueSize"]),this.__processValueSize())}getValueSize(){return null!==this.__valueSize&&this.__valueSize,this.__valueSize}__processValueSize(){this.__processInputData()}setValueLabelX(e){var i=t.ValueConverter.toString(e);null===i&&(i=this.getAttributeDefaultValueInternal("ValueLabelX")),JSON.stringify(i)!==JSON.stringify(this.__valueLabelX)&&(this.__valueLabelX=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getValueLabelX"]),this.__processValueLabelX())}getValueLabelX(){return this.__valueLabelX}__processValueLabelX(){}setShowAxisLabels(e){var i=t.ValueConverter.toBoolean(e);null===i&&(i=this.getAttributeDefaultValueInternal("ShowAxisLabels")),i!==this.__showAxisLabels&&(this.__showAxisLabels=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getShowAxisLabels"]),this.__processShowAxisLabels())}getShowAxisLabels(){return this.__showAxisLabels}__processShowAxisLabels(){1==this.__showAxisLabels?this.__elementChartCoordSystemText.css("display","block"):this.__elementChartCoordSystemText.css("display","none"),this.__firstRun=!0,this.__processLineChart()}setXLabel(e){var i=t.ValueConverter.toString(e);null===i&&(i=this.getAttributeDefaultValueInternal("XLabel")),i!==this.__xLabel&&(this.__xLabel=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getXLabel"]),this.__processXLabel())}getXLabel(){return this.__xLabel}__processXLabel(){this.__elementChartCoordSystemText[0].textContent=this.__xLabel}setYLabel(e){var i=t.ValueConverter.toString(e);null===i&&(i=this.getAttributeDefaultValueInternal("YLabel")),i!==this.__yLabel&&(this.__yLabel=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getYLabel"]),this.__processYLabel())}getYLabel(){return this.__yLabel}__processYLabel(){this.__elementChartCoordSystemText[1].textContent=this.__yLabel}setAxisLabelSize(e){var i=t.ValueConverter.toNumber(e);null===i&&(i=this.getAttributeDefaultValueInternal("AxisLabelSize")),JSON.stringify(i)!==JSON.stringify(this.__axisLabelSize)&&(this.__axisLabelSize=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getAxisLabelSize"]),this.__processAxisLabelSize())}getAxisLabelSize(){return this.__axisLabelSize}__processAxisLabelSize(){this.__elementChartCoordSystemText.css("font-size",this.__axisLabelSize+"px"),this.__elementChartCoordSystemText[1].setAttribute("x",this.__axisLabelSize/2+"px"),this.__elementChartCoordSystemText[1].setAttribute("transform","rotate(-90, "+(1+this.__axisLabelSize/2)+",135)")}setPointSize(e){var i=t.ValueConverter.toNumber(e);null===i&&(i=this.getAttributeDefaultValueInternal("PointSize")),JSON.stringify(i)!==JSON.stringify(this.__pointSize)&&(this.__pointSize=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getPointSize"]),this.__processPointSize())}getPointSize(){return this.__pointSize}__processPointSize(){if(this.__elementChartYPoints=this.__elementTemplateRoot.find(".tchmi-integrator-graph-points"),this.__elementChartYPoints.length>0)for(var t=0;t<this.__elementChartYPoints.length;t++)this.__elementChartYPoints[t].setAttribute("r",this.__pointSize+"px")}setPointColor(e){var i=t.ValueConverter.toString(e.color);null===i&&(i=this.getAttributeDefaultValueInternal("PointColor")),i!==this.__pointColor&&(this.__pointColor=this.rgbaToHex(i),t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getPointColor"]),this.__processPointColor())}getPointColor(){return this.__pointColor}__processPointColor(){this.__processColor()}setChartType(e){var i=t.ValueConverter.toString(e);null!==i?i!==this.__chartType&&(this.__chartType=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getChartType"]),this.__processChartType()):i=this.getAttributeDefaultValueInternal("ChartType")}getChartType(){return this.__chartType}__processChartType(){"Lines & Points"===this.__chartType?(this.__elementChartYPoints.css("display","block"),this.__elementChartGraphLine.css("display","block")):"Lines"===this.__chartType?(this.__elementChartYPoints.css("display","none"),this.__elementChartGraphLine.css("display","block")):"Points"===this.__chartType?(this.__elementChartYPoints.css("display","block"),this.__elementChartGraphLine.css("display","none")):(this.__elementChartYPoints.css("display","none"),this.__elementChartGraphLine.css("display","none"))}setLineWidth(e){var i=t.ValueConverter.toNumber(e);null===i&&(i=this.getAttributeDefaultValueInternal("LineWidth")),JSON.stringify(i)!==JSON.stringify(this.__lineWidth)&&(this.__lineWidth=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getLineWidth"]),this.__processLineWidth())}getLineWidth(){return this.__lineWidth}__processLineWidth(){this.__elementChartGraphLine[0].setAttribute("stroke-width",this.__lineWidth+"px")}setKeepNullAxis(e){var i=t.ValueConverter.toBoolean(e);null===i&&(i=this.getAttributeDefaultValueInternal("KeepNullAxis")),i!==this.__keepNullAxis&&(this.__keepNullAxis=i,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getKeepNullAxis"]),this.__processKeepNullAxis())}getKeepNullAxis(){return this.__keepNullAxis}__processKeepNullAxis(){var t=this.__elementTemplateRoot.find(".tchmi-integrator-lines-zero-line");void 0!==t&&(1==this.__keepNullAxis?t.css("display","block"):t.css("display","none"))}__processInputData(){if(void 0!==this.__valueSize&&null!==this.__valueSize&&this.__valueSize<this.__dataPointsY.length)for(let t=0;t<this.__dataPointsY.length-this.__valueSize;t++)this.__dataPointsY.shift();null!=this.__yValue&&null!=this.__valueSize&&(this.__dataPointsY.length<=this.__valueSize||this.__dataPointsY.shift(),this.__dataPointsY.push(this.__yValue),this.__processLineChart())}__processColorGradient(){this.__processColor()}__processColor(){this.__elementChartCoordSystem.css("stroke",this.__fontColor),this.__elementChartCoordSystemText.css("fill",this.__fontColor),this.__elementChartYAxisLabel.css("fill",this.__fontColor),this.__elementChartYLines=this.__elementTemplateRoot.find(".tchmi-integrator-lines"),this.__elementChartYLines.css("stroke",this.__controlColorLightPlus),this.__elementChartYPoints=this.__elementTemplateRoot.find(".tchmi-integrator-graph-points"),this.__elementChartDefs[0].innerHTML="",void 0!==this.__colorGradient&&void 0!==this.__pointColor&&this.CreateRadialGradient(this.hexToRgbA(this.__pointColor),this.__elementChartDefs[0],this.__colorGradient,this.__radialGrad+this.__secureId+"Point"),this.__elementChartYPoints.css("fill","url(#"+this.__radialGrad+this.__secureId+"Point)"),this.__elementChartGraphLine.css("stroke",this.__controlColorMiddle)}__processLineChart(){if(void 0!==this.__showAxisLabels&&null!==this.__showAxisLabels&&void 0!==this.__chartType&&null!==this.__chartType&&this.__dataPointsY.length>0){let t=[];this.__dataPointsY.length<=1?(this.__dataPointsY.unshift(0),t=this.__dataPointsY):t=this.__dataPointsY,this.DrawLineChart(this.__showAxisLabels,t)}}getMaxDataYValue(t){let e=t[0];for(var i=0;i<t.length;i++)t[i]>e&&(e=t[i]);return!0===t.nullAxis&&e<0&&(e=0),e}DrawLineChart(e,i){if(1==e)var s=237,r=50;else s=260,r=35;if(i.length>0){var n=this.getMaxDataYValue(i),a=this.getMinDataYValue(i);if(1==this.__firstRun||a<this.__oldMinValue||n>this.__oldMaxValue){this.__firstRun=!1;var _="M"+r+","+s+" L"+r+",10 L"+(r-4)+",14 L"+r+",10 L"+(r+4)+",14",l="M"+r+","+s+" L440,"+s+" L436,"+(s-4)+" L440,"+s+" L436,"+(s+4);this.__elementChartCoordSystem[0].setAttribute("d",l),this.__elementChartCoordSystem[1].setAttribute("d",_);let e=n-a,i=5;var h=0;if(e>0)for(;e<5;)n*=10,a*=10,e*=10,h++;var o=14,u=document.createElement("canvas").getContext("2d");u.font="bold "+o.toString()+"px sans-serif";let g=this.getTrimmedNumber(n),b=u.measureText(t.ValueConverter.toString(g)).width;for(;b>=30;)o-=1,u.font="bold "+t.ValueConverter.toString(o)+"px sans-serif",b=u.measureText(t.ValueConverter.toString(g)).width;for(this.__elementChartYAxisLabel.css("font-size",o+"px"),this.__elementChartYAxisLabel.css("display","none"),this.__elementChartYLines=this.__elementTemplateRoot.find(".tchmi-integrator-lines");this.__elementChartYLines.length>0;)this.__elementChartYLines[0].parentNode.removeChild(this.__elementChartYLines[0]),this.__elementChartYLines=this.__elementTemplateRoot.find(".tchmi-integrator-lines");const L=Math.round((n-a)/i);if(0===L)return;let x;x=a<=0&&n>=0?0:a;for(var d=x,p=0,m=(s-10)/(n-a);d<=n;){if((C=(n-d)*m+10)<s-1){var c=this.drawHorizontalLine(r+1,C,440,"tchmi-integrator-lines");this.__elementChart[0].insertAdjacentElement("afterbegin",c)}null!=this.__elementChartYAxisLabel[p]&&(this.__elementChartYAxisLabel[p].textContent=this.getTrimmedNumber(d/Math.pow(10,h)),this.__elementChartYAxisLabel[p].style.display="block",this.__elementChartYAxisLabel[p].setAttribute("y",C+o/3+"px"),this.__elementChartYAxisLabel[p].setAttribute("x",r-4+"px")),d+=L,p++}for(d=x,m=(s-10)/(n-a);d>a;){var C;if((C=(n-d)*m+10)<s-1){c=this.drawHorizontalLine(r+1,C,440,"tchmi-integrator-lines");this.__elementChart[0].insertAdjacentElement("afterbegin",c)}this.__elementChartYAxisLabel[p].textContent=this.getTrimmedNumber(d/Math.pow(10,h)),this.__elementChartYAxisLabel[p].style.display="block",this.__elementChartYAxisLabel[p].setAttribute("y",C+o/3+"px"),this.__elementChartYAxisLabel[p].setAttribute("x",r-4+"px"),d-=L,p++}this.__oldMinValue=a/Math.pow(10,h),this.__oldMaxValue=n/Math.pow(10,h)}h>0&&(n/=Math.pow(10,h),a/=Math.pow(10,h));m=(s-10)/(n-a);var g="";for(this.__elementChartYPoints=this.__elementTemplateRoot.find(".tchmi-integrator-graph-points");this.__elementChartYPoints.length>0;)this.__elementChartYPoints[0].parentNode.removeChild(this.__elementChartYPoints[0]),this.__elementChartYPoints=this.__elementTemplateRoot.find(".tchmi-integrator-graph-points");for(var b=1;b<i.length;b++){var L;L=i.length<3?Math.round((440-r)/3):Math.round((440-r)/(i.length-2));var x=(n-i[b])*m+10;x<10&&(x=10),x>s&&(x=s);var v=(b-1)*L+r;1==b&&(g="M"+v+","+x),b>1&&(g=g+" L"+v+","+x),this.__elementChartGraphLine[0].setAttribute("d",g);var f=this.drawPoint(v,x,5,"tchmi-integrator-graph-points");this.__elementChart[0].appendChild(f),this.__processPointSize()}this.__processColor()}}}e.Integrator=i}(i=e.Analytics||(e.Analytics={})),e.registerEx("Integrator","TcHmi.Controls.Analytics",i.Integrator)}(e=t.Controls||(t.Controls={}))}(TcHmi||(TcHmi={}));