var TcHmi;!function(t){let i;!function(i){let e;!function(i){class e extends t.Controls.Analytics.AnalyticsControl{constructor(i,e,s){super(i,e,s),this.__data=[],this.__lineDescs=[],this.__yAxisMaxValue=Number.MIN_SAFE_INTEGER,this.__yAxisMinValue=Number.MAX_SAFE_INTEGER,this.__xAxisMaxValue=Number.MIN_SAFE_INTEGER,this.__xAxisMinValue=Number.MAX_SAFE_INTEGER,this.__buttonIndex=0,this.__onResized=()=>(t,i)=>{super.__getScaleFactor();0!=this.__hasLicense&&(this.__showReset?this.__elementNameAlias.css("padding-right","16px"):this.__elementNameAlias.css("padding-right","5px"))},this.__onResolverForInputItemLRWatchCallback=i=>{!1===this.__isAttached&&this.__suspendObjectResolver("InputItemLR"),i.error===t.Errors.NONE?tchmi_equal(i.value,this.__inputItemLR)||(this.__inputItemLR=i.value,t.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"InputItem"}),this.__processInputItemLR()):TCHMI_CONSOLE_LOG_LEVEL>=1&&t.Log.error("[Source=Control, Module=TcHmi.Controls.Analytics.LinearRegression, Id="+this.getId()+", Attribute=InputItemLR] Resolving symbols from object failed with error: "+t.Log.buildMessage(i.details))}}__previnit(){super.__previnit(),0!=this.__hasLicense&&(this.__defaultWidth=630,this.__defaultHeight=470,this.__lineChart=t.Controls.get(this.__id+"_LineChart"),this.__elButtonContainer=this.__elementTemplateRoot.find(".tchmi-linear-regression-chart-buttons"),this.__elButtons=this.__elementTemplateRoot.find(".tchmi-linear-regression-chart-button"),this.__elCheckboxContainer=this.__elementTemplateRoot.find(".tchmi-linear-regression-chart-check-box-container"),this.__elTimeBox=this.__elementTemplateRoot.find(".tchmi-den-stream-chart-timestamps-box"),this.__elStartTime=this.__elementTemplateRoot.find(".tchmi-linear-regression-chart-start-time"),this.__elAvgTime=this.__elementTemplateRoot.find(".tchmi-linear-regression-chart-avg-time"),this.__elEndTime=this.__elementTemplateRoot.find(".tchmi-linear-regression-chart-end-time"))}__init(){super.setEditableProperties([]),super.__init()}__attach(){super.__attach()}__detach(){super.__detach()}destroy(){this.__keepAlive||super.destroy()}__onButtonClicked(t){return()=>{this.__yAxisMaxValue=Number.MIN_SAFE_INTEGER,this.__yAxisMinValue=Number.MAX_SAFE_INTEGER,this.__xAxisMaxValue=Number.MIN_SAFE_INTEGER,this.__xAxisMinValue=Number.MAX_SAFE_INTEGER,this.__buttonIndex=t,this.__drawCharting()}}setInputItemLR(i){let e=t.ValueConverter.toObject(i);null===e&&(e=this.getAttributeDefaultValueInternal("InputItemLR"));let s=this.__objectResolvers.get("InputItemLR");s&&(s.watchDestroyer&&s.watchDestroyer(),s.resolver.destroy());let _=new t.Symbol.ObjectResolver(e);this.__objectResolvers.set("InputItemLR",{resolver:_,watchCallback:this.__onResolverForInputItemLRWatchCallback,watchDestroyer:_.watch(this.__onResolverForInputItemLRWatchCallback)})}getInputItemLR(){return this.__inputItemLR}__processInputItemLR(){this.__drawCharting()}setControlType(i){var e=t.ValueConverter.toString(i);null!==e?e!==this.__controlType&&(this.__controlType=e,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getControlType"]),this._processControlType()):e=this.getAttributeDefaultValueInternal("ControlType")}getControlType(){return this.__controlType}_processControlType(){this.__input_x_CollectionLR=null,this.__dependent_y_CollectionLR=null,this.__drawCharting()}setCountValues(i){var e=t.ValueConverter.toNumber(i);null===e&&(e=this.getAttributeDefaultValueInternal("CountValues")),JSON.stringify(e)!==JSON.stringify(this.__countValues)&&(this.__countValues=e,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getCountValues"]),this.__processCountValues())}getCountValues(){return this.__countValues}__processCountValues(){this.__drawCharting()}setDownSizingFactor(i){var e=t.ValueConverter.toNumber(i);null===e&&(e=this.getAttributeDefaultValueInternal("DownSizingFactor")),JSON.stringify(e)!==JSON.stringify(this.__downSizingFactor)&&(this.__downSizingFactor=e,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getDownSizingFactor"]),this.__processDownSizingFactor())}getDownSizingFactor(){return this.__downSizingFactor}__processDownSizingFactor(){this.__drawCharting()}setAxisRangeScaling(i){var e=t.ValueConverter.toString(i);null!==e?e!==this.__axisRangeScaling&&(this.__axisRangeScaling=e,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getAxisRangeScaling"]),this.__processAxisRangeScaling()):e=this.getAttributeDefaultValueInternal("AxisRangeScaling")}getAxisRangeScaling(){return this.__axisRangeScaling}__processAxisRangeScaling(){this.__drawCharting()}setXAxisRanges(i){var e=t.ValueConverter.toObject(i);null===e&&(e=this.getAttributeDefaultValueInternal("XAxisRanges")),e!==this.__xAxisRanges&&(this.__xAxisRanges=e,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getXAxisRanges"]),this.__processXAxisRanges())}getXAxisRanges(){return this.__xAxisRanges}__processXAxisRanges(){this.__drawCharting()}setYAxisRanges(i){var e=t.ValueConverter.toObject(i);null===e&&(e=this.getAttributeDefaultValueInternal("YAxisRanges")),e!==this.__yAxisRanges&&(this.__yAxisRanges=e,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getYAxisRanges"]),this.__processYAxisRanges())}getYAxisRanges(){return this.__yAxisRanges}__processYAxisRanges(){this.__drawCharting()}setInputAlias(i){var e=t.ValueConverter.toString(i);null===e&&(e=this.getAttributeDefaultValueInternal("InputAlias")),e!==this.__inputAlias&&(this.__inputAlias=e,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getInputAlias"]),this.__processInputAlias())}getInputAlias(){return this.__inputAlias}__processInputAlias(){this.__drawCharting()}setLineColor(i){var e=t.ValueConverter.toString(i.color);null===e&&(e=this.getAttributeDefaultValueInternal("LineColor")),e!==this.__lineColor&&(this.__lineColor=e,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getLineColor"]),this.__processLineColor())}getLineColor(){return this.__lineColor}__processLineColor(){this.__drawCharting()}setHighlightColor(i){var e=t.ValueConverter.toString(i.color);null===e&&(e=this.getAttributeDefaultValueInternal("HighlightColor")),e!==this.__highlightColor&&(this.__highlightColor=e,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getHighlightColor"]),this.__processHighlightColor())}getHighlightColor(){return this.__highlightColor}__processHighlightColor(){this.__drawCharting()}setPointColor(i){var e=t.ValueConverter.toString(i.color);null===e&&(e=this.getAttributeDefaultValueInternal("PointColor")),e!==this.__pointColor&&(this.__pointColor=e,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getPointColor"]),this.__processPointColor())}getPointColor(){return this.__pointColor}__processPointColor(){this.__drawCharting()}__processFontColor(){if(super.__processFontColor(),void 0!==this.__solidFontColor&&null!==this.__solidFontColor){this.__lineChart.setXAxisColor(this.__solidFontColor),this.__lineChart.setXLabelFontColor(this.__solidFontColor),this.__lineChart.setGridLineColor(this.__solidFontColor);var t=tchmi_clone_object(this.__lineChart.getYAxis()),i=this;t.forEach((function(t){t.axisColor=i.__solidFontColor,t.axisNameFontColor=i.__solidFontColor,t.labelFontColor=i.__solidFontColor})),this.__lineChart.setYAxis(t)}}__processColor(){this.__elButtons.hover((function(){"rgba(128, 128, 128, 0.7)"!==$(this).css("background-color")&&$(this).css("background-color","rgba(128, 128, 128, 0.45)")}),(function(){"rgba(128, 128, 128, 0.7)"!==$(this).css("background-color")&&$(this).css("background-color","rgba(128, 128, 128, 0.3)")})),this.__elButtons.css("color",this.__fontColor),this.__elTimeBox.css("fill",this.__fontColor)}__drawCharting(){null!=this.__highlightColor&&null!=this.__pointColor&&null!=this.__lineColor&&null!=this.__inputItemLR&&null!=this.__countValues&&null!=this.__downSizingFactor&&null!=this.__axisRangeScaling&&null!=this.__yAxisRanges&&null!=this.__xAxisRanges&&("Curve Fitting"!=this.__controlType&&"Inference"!=this.__controlType||this.__drawLinearRegression())}__drawLinearRegression(){var t=this.__inputItemLR.Inputs.length;for(this.__elButtons=this.__elementTemplateRoot.find(".tchmi-linear-regression-chart-button");this.__elButtons.length>t;)this.__elButtons[0].parentNode.removeChild(this.__elButtons[0]),this.__elButtons=this.__elementTemplateRoot.find(".tchmi-linear-regression-chart-button");for(var i=this.__elButtons.length;i<t;i++){var e=document.createElement("button");e.classList.add("tchmi-linear-regression-chart-button","tchmi-linear-regression-chart-button_"+i.toString(),"tchmi-analytics-text","tchmi-box"),e.addEventListener("mousedown",this.__onButtonClicked(i)),this.__elButtonContainer[0].appendChild(e),this.__elButtons=this.__elementTemplateRoot.find(".tchmi-linear-regression-chart-button")}this.__elButtons=this.__elementTemplateRoot.find(".tchmi-linear-regression-chart-button");for(i=0;i<this.__elButtons.length;i++)this.__elButtons[i].innerHTML=this.__inputAlias+" "+i.toString();for(var s=this.__buttonIndex,_=0;_<this.__elButtons.length;++_)_!=s&&($(this.__elButtons[_]).css("border-color","rgba(64,64,64,0)"),$(this.__elButtons[_]).css("background-color","rgba(128, 128, 128, 0.3)"));if($(this.__elButtons[s]).css("border-color","rgba(64,64,64,0.5)"),$(this.__elButtons[s]).css("background-color","rgba(128, 128, 128, 0.7)"),null==this.__input_x_CollectionLR){this.__input_x_CollectionLR=new Array(this.__inputItemLR.Inputs.length);for(_=0;_<this.__inputItemLR.Inputs.length;_++)this.__input_x_CollectionLR[_]=new Array}null==this.__dependent_y_CollectionLR&&(this.__dependent_y_CollectionLR=new Array);for(_=0;_<this.__inputItemLR.Inputs.length;_++)this.__input_x_CollectionLR[_].push(this.__inputItemLR.Inputs[_].sValue);function n(t){return"string"==typeof t?parseFloat(t):t}"Curve Fitting"==this.__controlType?this.__dependent_y_CollectionLR.push(n(this.__inputItemLR.Dependent)):this.__dependent_y_CollectionLR.push(n(this.__inputItemLR.Result));var o={yAxisId:1,lineWidth:1,pointDot:!1,lineColor:{color:"rgba(71, 148, 218, 0)"}},l={yAxisId:1,lineWidth:0,pointDot:!0,pointDotRadius:3,pointDotStrokeWidth:1,pointDotFillColor:{color:"rgba(71, 148, 218, 0)"},pointDotStrokeColor:{color:"rgba(71, 148, 218, 0)"}};void 0!==this.__input_x_CollectionLR&&null!==this.__input_x_CollectionLR||(this.__input_x_CollectionLR=[[]]);var r=this.__input_x_CollectionLR[0].length;if(0==r)return;this.__downSizingFactor<1&&(this.__downSizingFactor=1);var a,h=r-this.__countValues*this.__downSizingFactor;a=(h=Math.floor(h/this.__downSizingFactor)*this.__downSizingFactor)>0?h:0,this.__data=[],this.__lineDescs=[];for(let t=a;t<this.__input_x_CollectionLR[s].length;t+=this.__downSizingFactor){var u=tchmi_clone_object(l),c=1-(this.__input_x_CollectionLR[s].length-1-t)/this.__downSizingFactor/this.__countValues,g=this.__pointColor.replace(/[^,]+(?=\))/,c.toString());u.pointDotFillColor={color:g},t+this.__downSizingFactor>=this.__input_x_CollectionLR[s].length?(u.pointDotStrokeColor={color:this.__highlightColor},u.pointDotStrokeWidth=3):u.pointDotStrokeColor={color:g},this.__lineDescs.push(u),this.__data.push([{x:n(this.__input_x_CollectionLR[s][t]),y:n(this.__dependent_y_CollectionLR[t])}]),"Auto"==this.__axisRangeScaling&&(n(this.__dependent_y_CollectionLR[t])<this.__yAxisMinValue&&(this.__yAxisMinValue=n(this.__dependent_y_CollectionLR[t])),n(this.__dependent_y_CollectionLR[t])>this.__yAxisMaxValue&&(this.__yAxisMaxValue=n(this.__dependent_y_CollectionLR[t])),n(this.__input_x_CollectionLR[s][t])<this.__xAxisMinValue&&(this.__xAxisMinValue=n(this.__input_x_CollectionLR[s][t])),n(this.__input_x_CollectionLR[s][t])>this.__xAxisMaxValue&&(this.__xAxisMaxValue=n(this.__input_x_CollectionLR[s][t])))}var p=n(this.__yAxisMaxValue),C=n(this.__yAxisMinValue),d=n(this.__xAxisMaxValue),x=n(this.__xAxisMinValue);"Manual"==this.__axisRangeScaling?(C=this.__xAxisRanges.Min,p=this.__xAxisRanges.Max,x=this.__yAxisRanges.Min,d=this.__yAxisRanges.Max):(this.__yAxisMaxValue<this.__yAxisMinValue?(p=100,C=0):this.__yAxisMaxValue-this.__yAxisMinValue<.1?(p=this.__yAxisMaxValue+1,C=this.__yAxisMinValue-1):(0!==p&&(p+=.05*(p-C),p=Math.ceil(p)),0!==C&&(C-=.05*(p-C),C=Math.floor(C))),this.__xAxisMaxValue<this.__xAxisMinValue?(d=100,x=0):this.__xAxisMaxValue-this.__xAxisMinValue<.1?(d=this.__xAxisMaxValue+1,x=this.__xAxisMinValue-1):(0!==d&&(d+=.05*(d-x),d=Math.ceil(d)),0!==x&&(x-=.05*(d-x),x=Math.floor(x))));const R=this;var A=tchmi_clone_object(this.__lineChart.getYAxis());A.forEach((function(t){t.mainTickMinValue=C,t.mainTickMaxValue=p,t.showAxis=!0,"Curve Fitting"==R.__controlType?t.axisName="Dependent":t.axisName="Result"})),this.__elEndTime.html(d.toString()),this.__elStartTime.html(x.toString()),this.__elAvgTime.html(this.getTrimmedNumber((x+d)/2));var m=this.__inputItemLR;for(_=0;_<this.__input_x_CollectionLR.length;_++)if(_==s){var v=tchmi_clone_object(o);v.lineColor={color:this.__lineColor},this.__lineDescs.push(v),this.__data.push([]);var b=n(m.Output00)+n(m.Output_i[_])*x;this.__data[this.__data.length-1].push({x:n(x),y:n(b)}),b=m.Output00+m.Output_i[_]*d,this.__data[this.__data.length-1].push({x:n(d),y:n(b)}),i+=1}this.__lineChart.setLineGraphDescriptions(tchmi_clone_object(this.__lineDescs)),this.__lineChart.setXAxisName(`${this.__inputAlias} ${s}`),this.__lineChart.setYAxis(A),this.__lineChart.setYMainTickSteps(6),this.__lineChart.setXMainTickMaxValue(d),this.__lineChart.setXMainTickMinValue(x),this.__lineChart.setLineGraphData(this.__data),this.__processColor()}}i.LinearRegression=e}(e=i.Analytics||(i.Analytics={})),i.registerEx("LinearRegression","TcHmi.Controls.Analytics",e.LinearRegression)}(i=t.Controls||(t.Controls={}))}(TcHmi||(TcHmi={}));