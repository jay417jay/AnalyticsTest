var TcHmi;!function(t){let e;!function(e){let s;!function(e){class s extends t.Controls.Analytics.AnalyticsControl{constructor(e,s,i){super(e,s,i),this.__radialGrad="radialGradXYGate",this.__linearGrad="linearGradXYGate",this.__onResized=()=>(t,e)=>{let s,i,n=super.__getScaleFactor();0!=this.__hasLicense&&(this.__showReset?this.__elementNameAlias.css("padding-right","16px"):this.__elementNameAlias.css("padding-right","5px"),!1===this.__showCounts?(s=30,this.__elementSvg.css("margin-bottom",20*n)):(s=0,!1===this.__showTitle&&(s=10,this.__elementSvg.css("margin-bottom",15*n)),this.__elementSvg.css("margin-bottom",5*n)),i=!0===this.__showMilliSeconds?10:12,this.__elementSvg.css("margin-top",s*n),this.__elementSvg.css("margin-left",40*n),this.__elementSvg.css("width",220*n),this.__elementSvg.css("height",220*n),this.__elementLastEvent.css("font-size",i*n),this.__elementLastEvent.css("margin-top",5*n),this.__elementCountGate.css("font-size",14*n),this.__elementCountGate.css("margin-top",5*n),this.__elementCountOutlier.css("font-size",14*n),this.__elementCountOutlier.css("margin-top",5*n))},this.__onResolverForConfigGate1WatchCallback=e=>{!1===this.__isAttached&&this.__suspendObjectResolver("configGate1"),e.error===t.Errors.NONE?tchmi_equal(e.value,this.__configGate1)||(this.__configGate1=e.value||null,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getConfigGate1"]),this.__processConfigGate1()):t.Log.error("[Source=Control, Module=TcHmi.Controls.Analytics.AnalyticsControl, Id="+this.getId()+", Attribute=ConfigGate1] Resolving symbols from object failed with error: "+t.Log.buildMessage(e.details))},this.__onResolverForConfigGate2WatchCallback=e=>{!1===this.__isAttached&&this.__suspendObjectResolver("configGate2"),e.error===t.Errors.NONE?tchmi_equal(e.value,this.__configGate2)||(this.__configGate2=e.value||null,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getConfigGate2"]),this.__processConfigGate2()):t.Log.error("[Source=Control, Module=TcHmi.Controls.Analytics.AnalyticsControl, Id="+this.getId()+", Attribute=ConfigGate2] Resolving symbols from object failed with error: "+t.Log.buildMessage(e.details))}}__previnit(){super.__previnit(),0!=this.__hasLicense&&(this.__defaultWidth=310,this.__defaultHeight=310,this.__elementSvg=this.__elementTemplateRoot.find(".tchmi-x-y-gate-monitor-svg"),this.__elementSvgDefs=this.__elementTemplateRoot.find(".tchmi-x-y-gate-monitor-defs"),this.__elementSvgLine=this.__elementTemplateRoot.find(".tchmi-x-y-gate-monitor-line"),this.__elementSvgCircle1=this.__elementTemplateRoot.find(".tchmi-x-y-gate-monitor-circle-one"),this.__elementSvgCircle2=this.__elementTemplateRoot.find(".tchmi-x-y-gate-monitor-circle-two"),this.__elementSvgCircleXY=this.__elementTemplateRoot.find(".tchmi-x-y-gate-monitor-circle-xy"),this.__elementSvgArrow=this.__elementTemplateRoot.find(".tchmi-x-y-gate-monitor-svg-arrow"),this.__elementCountGate=this.__elementTemplateRoot.find(".tchmi-x-y-gate-monitor-count-gate"),this.__elementCountOutlier=this.__elementTemplateRoot.find(".tchmi-x-y-gate-monitor-count-outlier"),this.__elementLastEvent=this.__elementTemplateRoot.find(".tchmi-x-y-gate-monitor-last-event"))}__init(){let t=[new e.Property(this,"ShowGateIntersection","Show Gate Intersection",e.E_DataType.BOOLEAN),new e.Property(this,"ShowDirection","Show Direction",e.E_DataType.BOOLEAN),new e.Property(this,"ShowCounts","Show Counts",e.E_DataType.BOOLEAN),new e.Property(this,"ShowCounts","Show Counts",e.E_DataType.BOOLEAN),new e.Property(this,"ShowLastEvent","Show Last Intersection",e.E_DataType.BOOLEAN),new e.Property(this,"IntersectionColor","Intersection Color",e.E_DataType.SOLIDCOLOR),new e.Property(this,"NoIntersectionColor","No Intersection Color",e.E_DataType.SOLIDCOLOR)];super.setEditableProperties(t),super.__init()}__attach(){super.__attach(),this.__processGates()}__detach(){super.__detach()}destroy(){this.__keepAlive||super.destroy()}setGateIntersectionsAlias(e){var s=t.ValueConverter.toString(e);null===s&&(s=this.getAttributeDefaultValueInternal("GateIntersectionsAlias")),s!==this.__gateIntersectionsAlias&&(this.__gateIntersectionsAlias=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getGateIntersectionsAlias"]),this.__processGateIntersectionsAlias(),t.EventProvider.raise(`${this.__id}.onResized`,null))}getGateIntersectionsAlias(){return this.__gateIntersectionsAlias}__processGateIntersectionsAlias(){this.__processCountGateIntersection()}setOutlierIntersectionsAlias(e){var s=t.ValueConverter.toString(e);null===s&&(s=this.getAttributeDefaultValueInternal("OutlierIntersectionsAlias")),s!==this.__outlierIntersectionsAlias&&(this.__outlierIntersectionsAlias=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getOutlierIntersectionsAlias"]),this.__processOutlierIntersectionsAlias(),t.EventProvider.raise(`${this.__id}.onResized`,null))}getOutlierIntersectionsAlias(){return this.__outlierIntersectionsAlias}__processOutlierIntersectionsAlias(){this.__processCountOutlierIntersection()}setLastIntersectionAlias(e){var s=t.ValueConverter.toString(e);null===s&&(s=this.getAttributeDefaultValueInternal("LastIntersectionAlias")),s!==this.__lastIntersectionAlias&&(this.__lastIntersectionAlias=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getLastIntersectionAlias"]),this.__processLastIntersectionAlias(),t.EventProvider.raise(`${this.__id}.onResized`,null))}getLastIntersectionAlias(){return this.__lastIntersectionAlias}__processLastIntersectionAlias(){this.__processLastEvent()}setMonthAlias(e){var s=t.ValueConverter.toString(e);null===s&&(s=this.getAttributeDefaultValueInternal("MonthAlias")),s!==this.__monthAlias&&(this.__monthAlias=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getMonthAlias"]),this.__processMonthAlias())}getMonthAlias(){return this.__monthAlias}__processMonthAlias(){e.DCTimestruct.monthAlias=this.__monthAlias,this.__processLastEvent()}setIntersectionColor(e){let s=t.ValueConverter.toObject(e);null===s&&(s=this.getAttributeDefaultValueInternal("IntersectionColor")),s!==this.__intersectionColor&&(this.__intersectionColor=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getIntersectionColor"]),this.__processIntersectionColor())}getIntersectionColor(){return this.__intersectionColor}__processIntersectionColor(){this.__processGates()}setNoIntersectionColor(e){let s=t.ValueConverter.toObject(e);null===s&&(s=this.getAttributeDefaultValueInternal("NoIntersectionColor")),s!==this.__noIntersectionColor&&(this.__noIntersectionColor=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getNoIntersectionColor"]),this.__processNoIntersectionColor())}getNoIntersectionColor(){return this.__noIntersectionColor}__processNoIntersectionColor(){this.__processGates()}setPointColor(e){let s=t.ValueConverter.toObject(e);null===s&&(s=this.getAttributeDefaultValueInternal("PointColor")),s!==this.__pointColor&&(this.__pointColor=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getPointColor"]),this.__processPointColor())}getPointColor(){return this.__pointColor}__processPointColor(){this.__processGates()}setConfigGate1(e){var s=t.ValueConverter.toObject(e);null===s&&(s=this.getAttributeDefaultValueInternal("ConfigGate1"));let i=this.__objectResolvers.get("configGate1");i&&(i.watchDestroyer&&i.watchDestroyer(),i.resolver.destroy());let n=new t.Symbol.ObjectResolver(s);this.__objectResolvers.set("configGate1",{resolver:n,watchCallback:this.__onResolverForConfigGate1WatchCallback,watchDestroyer:n.watch(this.__onResolverForConfigGate1WatchCallback)})}getConfigGate1(){return this.__configGate1}__processConfigGate1(){this.__processGates()}setConfigGate2(e){var s=t.ValueConverter.toObject(e);null===s&&(s=this.getAttributeDefaultValueInternal("ConfigGate2"));let i=this.__objectResolvers.get("configGate2");i&&(i.watchDestroyer&&i.watchDestroyer(),i.resolver.destroy());let n=new t.Symbol.ObjectResolver(s);this.__objectResolvers.set("configGate2",{resolver:n,watchCallback:this.__onResolverForConfigGate2WatchCallback,watchDestroyer:n.watch(this.__onResolverForConfigGate2WatchCallback)})}getConfigGate2(){return this.__configGate2}__processConfigGate2(){this.__processGates()}setGateIntersection(e){var s=t.ValueConverter.toBoolean(e);null!==s?s!==this.__gateIntersection&&(this.__gateIntersection=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getGateIntersection"]),this.__processGateIntersection()):s=this.getAttributeDefaultValueInternal("GateIntersection")}getGateIntersection(){return this.__gateIntersection}__processGateIntersection(){this.__processGates()}setOutlierIntersection(e){var s=t.ValueConverter.toBoolean(e);null!==s?s!==this.__outlierIntersection&&(this.__outlierIntersection=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getOutlierIntersection"]),this.__processOutlierIntersection()):s=this.getAttributeDefaultValueInternal("OutlierIntersection")}getOutlierIntersection(){return this.__outlierIntersection}__processOutlierIntersection(){this.__processGates()}setIntersectionX(e){var s=t.ValueConverter.toNumber(e);null===s&&(s=this.getAttributeDefaultValueInternal("IntersectionX")),s!==this.__intersectionX&&(this.__intersectionX=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getIntersectionX"]),this.__processIntersectionX())}getIntersectionX(){return this.__intersectionX}__processIntersectionX(){this.__processGates()}setIntersectionY(e){var s=t.ValueConverter.toNumber(e);null===s&&(s=this.getAttributeDefaultValueInternal("IntersectionY")),s!==this.__intersectionY&&(this.__intersectionY=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getIntersectionY"]),this.__processIntersectionY())}getIntersectionY(){return this.__intersectionY}__processIntersectionY(){this.__processGates()}setShowDirection(e){var s=t.ValueConverter.toBoolean(e);null!==s?s!==this.__showDirection&&(this.__showDirection=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getShowDirection"]),this.__processShowDirection()):s=this.getAttributeDefaultValueInternal("ShowDirection")}getShowDirection(){return this.__showDirection}__processShowDirection(){this.__showDirection?this.__elementSvgArrow.css("visibility","visible"):this.__elementSvgArrow.css("visibility","collapse"),this.__processGates()}setShowGateIntersection(e){var s=t.ValueConverter.toBoolean(e);null!==s?s!==this.__showGateIntersection&&(this.__showGateIntersection=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getShowGateIntersection"]),this.__processShowGateIntersection()):s=this.getAttributeDefaultValueInternal("ShowGateIntersection")}getShowGateIntersection(){return this.__showGateIntersection}__processShowGateIntersection(){this.__processGates()}__processColorGradient(){this.__processColor()}__processColor(){this.__elementSvgArrow.css("stroke",this.__fontColor),this.__processGates()}__processGates(){this.__isAttached&&this.DrawGate(this.__configGate1,this.__configGate2,this.__gateIntersection,this.__outlierIntersection,this.__intersectionX,this.__intersectionY,this.__showGateIntersection,this.__showDirection,this.__intersectionColor.color,this.__noIntersectionColor.color,this.__pointColor.color,this.__fontColor,this.__controlColorDark)}setCountGateIntersection(e){var s=t.ValueConverter.toNumber(e);null===s&&(s=this.getAttributeDefaultValueInternal("CountGateIntersection")),s!==this.__countGateIntersection&&(this.__countGateIntersection=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getCountGateIntersection"]),this.__processCountGateIntersection())}getCountGateIntersection(){return this.__countGateIntersection}__processCountGateIntersection(){this.__elementCountGate[0].innerHTML=this.__gateIntersectionsAlias+": "+this.__countGateIntersection}setCountOutlierIntersection(e){var s=t.ValueConverter.toNumber(e);null===s&&(s=this.getAttributeDefaultValueInternal("CountOutlierIntersection")),s!==this.__countOutlierIntersection&&(this.__countOutlierIntersection=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getCountOutlierIntersection"]),this.__processCountOutlierIntersection())}getCountOutlierIntersection(){return this.__countOutlierIntersection}__processCountOutlierIntersection(){this.__elementCountOutlier[0].innerHTML=this.__outlierIntersectionsAlias+": "+this.__countOutlierIntersection}setShowCounts(e){var s=t.ValueConverter.toBoolean(e);null!==s?s!==this.__showCounts&&(this.__showCounts=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getShowCounts"]),this.__processShowCounts()):s=this.getAttributeDefaultValueInternal("ShowCounts")}getShowCounts(){return this.__showCounts}__processShowCounts(){!0===this.__showCounts?(this.__elementCountGate.css("display","block"),this.__elementCountOutlier.css("display","block")):(this.__elementCountGate.css("display","none"),this.__elementCountOutlier.css("display","none")),t.EventProvider.raise(`${this.__id}.onResized`,null)}setLastEvent(e){var s=t.ValueConverter.toObject(e);null===s&&(s=this.getAttributeDefaultValueInternal("LastEvent")),JSON.stringify(s)!==JSON.stringify(this.__lastEvent)&&(this.__lastEvent=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getLastEvent"]),this.__processLastEvent())}getLastEvent(){return this.__lastEvent}setShowMilliSeconds(e){var s=t.ValueConverter.toBoolean(e);null===s&&(s=this.getAttributeDefaultValueInternal("ShowMilliSeconds")),s!==this.__showMilliSeconds&&(this.__showMilliSeconds=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getShowMilliSeconds"]),this.__processShowMilliSeconds())}getShowMilliSeconds(){return this.__showMilliSeconds}__processShowMilliSeconds(){this.__processLastEvent(),t.EventProvider.raise(`${this.__id}.onResized`,null)}__processLastEvent(){void 0!==this.__lastEvent&&void 0!==this.__monthAlias&&null!==this.__monthAlias&&void 0!==this.__showMilliSeconds&&null!==this.__showMilliSeconds&&(this.__elementLastEvent[0].innerHTML=this.__lastIntersectionAlias+": "+this.DateTimeConverter(this.__lastEvent,this.__monthAlias,this.__showMilliSeconds))}setShowLastEvent(e){var s=t.ValueConverter.toBoolean(e);null!==s?s!==this.__showLastEvent&&(this.__showLastEvent=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getShowLastEvent"]),this.__processShowLastEvent()):s=this.getAttributeDefaultValueInternal("ShowLastEvent")}getShowLastEvent(){return this.__showLastEvent}__processShowLastEvent(){!0===this.__showLastEvent?this.__elementLastEvent.css("display","block"):this.__elementLastEvent.css("display","none"),t.EventProvider.raise(`${this.__id}.onResized`,null)}DrawGate(t,e,s,i,n,o,r,_,l,a,h,c,u){let g,v,d,C,I,m,p,G=0,S=t.X,f=e.X,w=t.Y,A=e.Y;if(this.__elementSvgDefs[0].innerHTML="",this.CreateRadialGradient(a,this.__elementSvgDefs[0],this.__colorGradient,this.__radialGrad+this.__secureId+"NoIntersectionColor"),this.CreateRadialGradient(l,this.__elementSvgDefs[0],this.__colorGradient,this.__radialGrad+this.__secureId+"IntersectionColor"),this.CreateRadialGradient(h,this.__elementSvgDefs[0],this.__colorGradient,this.__radialGrad+this.__secureId+"PointColor"),this.CreateLinearGradient(a,this.__elementSvgDefs[0],this.__colorGradient,this.__linearGrad+this.__secureId+"NoIntersectionColor"),this.CreateLinearGradient(l,this.__elementSvgDefs[0],this.__colorGradient,this.__linearGrad+this.__secureId+"IntersectionColor"),f===S?(C=10,I=130,d=70,G=70,m=d,p=120):A===w?(C=70,I=70,d=10,G=130,p=C,m=120):(g=(A-w)/(f-S),v=w-g*S,C=v,I=g*G+v,g>=-.5&&g<=.5?(d=10,G=130,C=g<0?35:100):g>=2||g<=-2?(d=45,G=95,C=g<0?10:130):(d=10,G=130,C=g<0?10:130),I=-1*(130*g-C),I<10?I=10:I>130&&(I=130),G>130&&(G=130),G<10&&(G=10),m=d+(G-d)*((n-S)/(f-S)),p=C+(I-C)*((o-w)/(A-w))),!0===s?f==S||A==w?this.__elementSvgLine.css("stroke",l):this.__elementSvgLine.css("stroke","url(#"+this.__linearGrad+this.__secureId+"IntersectionColor)"):f==S||A==w?this.__elementSvgLine.css("stroke",a):this.__elementSvgLine.css("stroke","url(#"+this.__linearGrad+this.__secureId+"NoIntersectionColor)"),this.__elementSvgLine.attr("x1",d),this.__elementSvgLine.attr("x2",G),this.__elementSvgLine.attr("y1",C),this.__elementSvgLine.attr("y2",I),i&&o<=w?this.__elementSvgCircle1.css("fill","url(#"+this.__radialGrad+this.__secureId+"IntersectionColor)"):this.__elementSvgCircle1.css("fill","url(#"+this.__radialGrad+this.__secureId+"NoIntersectionColor)"),this.__elementSvgCircle1.css("stroke",l),this.__elementSvgCircle1.attr("cx",d),this.__elementSvgCircle1.attr("cy",C),i&&o>=A?this.__elementSvgCircle2.css("fill","url(#"+this.__radialGrad+this.__secureId+"IntersectionColor)"):this.__elementSvgCircle2.css("fill","url(#"+this.__radialGrad+this.__secureId+"NoIntersectionColor)"),this.__elementSvgCircle2.css("stroke",l),this.__elementSvgCircle2.attr("cx",G),this.__elementSvgCircle2.attr("cy",I),s&&r?this.__elementSvgCircleXY.css("fill","url(#"+this.__radialGrad+this.__secureId+"PointColor)"):this.__elementSvgCircleXY.css("fill","none"),this.__elementSvgCircleXY.attr("cx",m),this.__elementSvgCircleXY.attr("cy",p),!0===_){let t,e,s,i,n,o,r,_,l=(d+G)/2,a=(C+I)/2;if(S===f||w===A){S===f&&(s=a,i=a,w<=A&&(t=l+25,e=l+10,n=l+15,r=l+15,o=a+5,_=a-5),w>A&&(t=l-25,e=l-10,n=l-15,r=l-15,o=a+5,_=a-5)),w===A&&(t=l,e=l,S<=f&&(s=a+25,i=a+10,o=a+15,_=a+15,n=l+5,r=l-5),S>f&&(s=l-25,i=l-10,o=a-15,_=a-15,n=l-5,r=l+5));var E="M"+t+","+s+" L"+e+","+i+" M"+n+","+o+" L"+e+","+i+" L"+r+","+_;this.__elementSvgArrow.attr("d",E),this.__elementSvgArrow.css("transform","")}else{let t=(C-I)/(G-d);if(t){var L=180*Math.atan(t)/Math.PI;L-=90;let e=0;S<f&&(e=1),S>f&&(e=-1);E="M"+5*e+",0 L"+25*e+",0 M"+5*e+",0 L"+10*e+","+5*e+" M"+5*e+",0 L"+10*e+","+-5*e;this.__elementSvgArrow.attr("d",E);var b="translate("+l+"px, "+a+"px) rotate("+-L+"deg)";this.__elementSvgArrow.css("transform",b)}}}}}e.XYGateMonitor=s}(s=e.Analytics||(e.Analytics={})),e.registerEx("XYGateMonitor","TcHmi.Controls.Analytics",s.XYGateMonitor)}(e=t.Controls||(t.Controls={}))}(TcHmi||(TcHmi={}));