var TcHmi;!function(t){let e;!function(e){let s;!function(e){class s extends t.Controls.Analytics.AnalyticsControl{constructor(t,e,s){super(t,e,s),this.__linearGrad="linearGradSlopeAnalysis",this.__onResized=()=>(t,e)=>{let s=super.__getScaleFactor(!0);if(0==this.__hasLicense)return;let i=this.__defaultHeight+18-this.__elementNameAlias[0].clientHeight;0==this.__showLastEvents&&(i+=24);var l=i/this.__defaultHeight;s=this.__getFontScaleFactor(void 0,i)*l,this.__showReset?this.__elementNameAlias.css("padding-right","16px"):this.__elementNameAlias.css("padding-right","5px"),this.__elementLastEvents.css("font-size",12*s),this.__elementLastEvents.css("padding-left",5*s);let _=250,n=200,o=15;!1!==this.__showLastEvents&&!1!==this.__showTitle||(_+=25,n+=20),!1===this.__showLastEvents&&!1===this.__showTitle&&(_+=25,n+=20),!1===this.__showLastEvents&&(o=25),this.__elementSvg.css("top",o*s),this.__elementSvg.css("margin-top",5*s),this.__elementSlopeMin.css("margin-top",5*s),this.__elementSvg.css("height",n*s),this.__elementSvg.css("width",_*s),this.__elementSvg.css("left",(300-_)/2*s),this.__elementContainer.css("height",280*s)}}__previnit(){super.__previnit(),0!=this.__hasLicense&&(this.__defaultWidth=310,this.__defaultHeight=310,this.__elementSvg=this.__elementTemplateRoot.find(".tchmi-slope-analysis-svg"),this.__elementSvgDefs=this.__elementTemplateRoot.find(".tchmi-slope-analysis-svg-defs"),this.__elementSvgSlope=this.__elementTemplateRoot.find(".tchmi-slope-analysis-svg-slope"),this.__elementSvgSlopeMin=this.__elementTemplateRoot.find(".tchmi-slope-analysis-svg-min-line"),this.__elementSvgSlopeMax=this.__elementTemplateRoot.find(".tchmi-slope-analysis-svg-max-line"),this.__elementSvgSlopeAct=this.__elementTemplateRoot.find(".tchmi-slope-analysis-svg-cur-line"),this.__elementSvgSlopeMinText=this.__elementTemplateRoot.find(".tchmi-slope-analysis-svg-text-min"),this.__elementSvgSlopeMaxText=this.__elementTemplateRoot.find(".tchmi-slope-analysis-svg-text-max"),this.__elementSvgSlopeActText=this.__elementTemplateRoot.find(".tchmi-slope-analysis-svg-text-cur"),this.__elementContainer=this.__elementTemplateRoot.find(".tchmi-slope-analysis-container"),this.__elementLastEvents=this.__elementTemplateRoot.find(".tchmi-slope-analysis-last-events"),this.__elementSlopeMin=this.__elementTemplateRoot.find(".tchmi-slope-analysis-slope-min"),this.__elementSlopeMax=this.__elementTemplateRoot.find(".tchmi-slope-analysis-slope-max"))}__init(){let t=[new e.Property(this,"AmountDecimals","Amount Decimals",e.E_DataType.UINTEGER),new e.Property(this,"ShowLastEvents","Show Last Events",e.E_DataType.BOOLEAN),new e.Property(this,"ShowMilliSeconds","Show Milliseconds",e.E_DataType.BOOLEAN)];super.setEditableProperties(t),super.__init()}__attach(){super.__attach()}__detach(){super.__detach()}destroy(){this.__keepAlive||super.destroy()}setMonthAlias(e){var s=t.ValueConverter.toString(e);null===s&&(s=this.getAttributeDefaultValueInternal("MonthAlias")),s!==this.__monthAlias&&(this.__monthAlias=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getMonthAlias"]),this.__processMonthAlias())}getMonthAlias(){return this.__monthAlias}__processMonthAlias(){e.DCTimestruct.monthAlias=this.__monthAlias,this.__processLastMin(),this.__processLastMax()}setMinAlias(e){var s=t.ValueConverter.toString(e);null===s&&(s=this.getAttributeDefaultValueInternal("MinAlias")),s!==this.__minAlias&&(this.__minAlias=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getMinAlias"]),this.__processMinAlias())}getMinAlias(){return this.__minAlias}__processMinAlias(){this.__processChart(),this.__processLastMin()}setMaxAlias(e){var s=t.ValueConverter.toString(e);null===s&&(s=this.getAttributeDefaultValueInternal("MaxAlias")),s!==this.__maxAlias&&(this.__maxAlias=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getMaxAlias"]),this.__processMaxAlias())}getMaxAlias(){return this.__maxAlias}__processMaxAlias(){this.__processChart(),this.__processLastMax()}setCurAlias(e){var s=t.ValueConverter.toString(e);null===s&&(s=this.getAttributeDefaultValueInternal("CurAlias")),s!==this.__minAlias&&(this.__curAlias=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getCurAlias"]),this.__processCurAlias())}getCurAlias(){return this.__curAlias}__processCurAlias(){this.__processChart()}setMin(e){var s=t.ValueConverter.toNumber(e);null===s&&(s=this.getAttributeDefaultValueInternal("Min")),s!==this.__min&&(this.__min=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getMin"]),this.__processMin())}getMin(){return this.__min}__processMin(){this.__processChart()}setMax(e){var s=t.ValueConverter.toNumber(e);null===s&&(s=this.getAttributeDefaultValueInternal("Max")),s!==this.__max&&(this.__max=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getMax"]),this.__processMax())}getMax(){return this.__max}__processMax(){this.__processChart()}setActualValue(e){var s=t.ValueConverter.toNumber(e);null===s&&(s=this.getAttributeDefaultValueInternal("ActualValue")),s!==this.__actualValue&&(this.__actualValue=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getActualValue"]),this.__processActualValue())}getActualValue(){return this.__actualValue}__processActualValue(){this.__processChart()}__processColorGradient(){this.__processColor()}__processColor(){this.__elementSvgDefs[0].innerHTML="",void 0!==this.__colorGradient&&void 0!==this.__controlColorDark&&(this.CreateLinearGradient(this.hexToRgbA(this.__controlColorDark),this.__elementSvgDefs[0],this.__colorGradient,this.__linearGrad+this.__secureId),this.__elementSvgDefs[0].children[0].setAttribute("y2","-10%"),this.__elementSvgSlope.css("stroke","url(#"+this.__linearGrad+this.__secureId+")")),this.__elementSvgSlope.css("fill","none"),this.__elementSvgSlopeMin.css("stroke",this.__controlColorDark),this.__elementSvgSlopeMin.css("fill","none"),this.__elementSvgSlopeMax.css("stroke",this.__controlColorDark),this.__elementSvgSlopeMax.css("fill","none"),this.__elementSvgSlopeAct.css("stroke",this.__controlColorDark),this.__elementSvgSlopeAct.css("fill","none"),this.__elementSvgSlopeMinText.css("fill",this.__controlColorDark),this.__elementSvgSlopeMaxText.css("fill",this.__controlColorDark),this.__elementSvgSlopeActText.css("fill",this.__controlColorDark)}__processChart(){null!=this.__min&&null!=this.__max&&null!=this.__actualValue&&null!=this.__minAlias&&null!=this.__maxAlias&&null!=this.__curAlias&&this.DrawSlopeChart(this.__min,this.__max,this.__actualValue,this.__minAlias,this.__maxAlias,this.__curAlias)}setShowLastEvents(e){var s=t.ValueConverter.toBoolean(e);null!==s?s!==this.__showLastEvents&&(this.__showLastEvents=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getShowLastEvents"]),this.__processShowLastEvents()):s=this.getAttributeDefaultValueInternal("ShowLastEvents")}getShowLastEvents(){return this.__showLastEvents}setShowMilliSeconds(e){var s=t.ValueConverter.toBoolean(e);null===s&&(s=this.getAttributeDefaultValueInternal("ShowMilliSeconds")),s!==this.__showMilliSeconds&&(this.__showMilliSeconds=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getShowMilliSeconds"]),this.__processShowMilliSeconds())}getShowMilliSeconds(){return this.__showMilliSeconds}__processShowMilliSeconds(){this.__processLastMin(),this.__processLastMax()}setLastMin(e){var s=t.ValueConverter.toObject(e);null===s&&(s=this.getAttributeDefaultValueInternal("LastMin")),JSON.stringify(s)!==JSON.stringify(this.__lastMin)&&(this.__lastMin=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getLastMin"]),this.__processLastMin())}getLastMin(){return this.__lastMin}setLastMax(e){var s=t.ValueConverter.toObject(e);null===s&&(s=this.getAttributeDefaultValueInternal("LastMax")),JSON.stringify(s)!==JSON.stringify(this.__lastMax)&&(this.__lastMax=s,t.EventProvider.raise(`${this.__id}.onFunctionResultChanged`,["getLastMax"]),this.__processLastMax())}getLastMax(){return this.__lastMax}__processShowLastEvents(){!0===this.__showLastEvents?(this.__elementSlopeMax.css("display","block"),this.__elementSlopeMin.css("display","block")):(this.__elementSlopeMax.css("display","none"),this.__elementSlopeMin.css("display","none")),this.__processChart(),t.EventProvider.raise(`${this.__id}.onResized`,null)}__processLastMin(){void 0!==this.__lastMin&&void 0!==this.__monthAlias&&void 0!==this.__showMilliSeconds&&null!==this.__monthAlias&&void 0!==this.__monthAlias&&null!==this.__showMilliSeconds&&(this.__elementSlopeMin[0].innerHTML=this.__minAlias+": &nbsp"+this.DateTimeConverter(this.__lastMin,this.__monthAlias,this.__showMilliSeconds))}__processLastMax(){void 0!==this.__lastMin&&void 0!==this.__monthAlias&&void 0!==this.__showMilliSeconds&&null!==this.__showMilliSeconds&&null!==this.__monthAlias&&void 0!==this.__monthAlias&&(this.__elementSlopeMax[0].innerHTML=this.__maxAlias+": "+this.DateTimeConverter(this.__lastMax,this.__monthAlias,this.__showMilliSeconds))}__processAmountDecimals(){super.__processAmountDecimals(),this.__processChart()}DrawSlopeChart(t,e,s,i,l,_){let n=this.getTrimmedNumber(t,"min"),o=this.getTrimmedNumber(e,"max"),a=this.getTrimmedNumber(s,"actual"),h=195,r=5;var c="M"+(125-250/3)+","+h+" A"+250/3+",95 0 0 1 125 100 A"+250/3+",95 0 0 0 "+(125+250/3)+" "+r;this.__elementSvgSlope[0].setAttribute("d",c),this.__elementSvgSlopeMax[0].setAttribute("x1",(125+250/3+30).toString()+"px"),this.__elementSvgSlopeMax[0].setAttribute("x2",(125+250/3-30).toString()+"px"),this.__elementSvgSlopeMax[0].setAttribute("y1",r.toString()+"px"),this.__elementSvgSlopeMax[0].setAttribute("y2",r.toString()+"px"),this.__elementSvgSlopeMin[0].setAttribute("x1",(125-250/3+30).toString()+"px"),this.__elementSvgSlopeMin[0].setAttribute("x2",(125-250/3-30).toString()+"px"),this.__elementSvgSlopeMin[0].setAttribute("y1",h.toString()+"px"),this.__elementSvgSlopeMin[0].setAttribute("y2",h.toString()+"px");let m,p=195;e-t>0&&(p=e-s>=0&&s>t?190*(e-s)/(e-t)+5:s<=t?h:5);let S=250/3,u=95;if(p<100){let t=-1*(p-5);m=125+Math.sqrt((S*S*u*u-S*S*t*t)/(u*u))}else if(p>100){let t=h-p;m=125-Math.sqrt((S*S*u*u-S*S*t*t)/(u*u))}else m=125;this.__elementSvgSlopeAct[0].setAttribute("x1",(m+30).toString()+"px"),this.__elementSvgSlopeAct[0].setAttribute("x2",(m-30).toString()+"px"),this.__elementSvgSlopeAct[0].setAttribute("y1",p.toString()+"px"),this.__elementSvgSlopeAct[0].setAttribute("y2",p.toString()+"px");let g=0;h-p<14&&(g=14-(h-p));let v=0;p-r<14&&(v=14-(p-r)),this.__elementSvgSlopeActText[0].textContent=_+": "+a,s<=t?(this.__elementSvgSlopeActText.css("text-anchor","end"),this.__elementSvgSlopeActText[0].setAttribute("x",245..toString()+"px"),this.__elementSvgSlopeActText[0].setAttribute("y",(h+3).toString()+"px")):s>=e?(this.__elementSvgSlopeActText.css("text-anchor","start"),this.__elementSvgSlopeActText[0].setAttribute("x",5..toString()+"px"),this.__elementSvgSlopeActText[0].setAttribute("y",(r+5).toString()+"px")):(this.__elementSvgSlopeActText[0].setAttribute("y",(p+5+v-g).toString()+"px"),p<100?(this.__elementSvgSlopeActText.css("text-anchor","end"),this.__elementSvgSlopeActText[0].setAttribute("x",(m-35).toString()+"px")):(this.__elementSvgSlopeActText.css("text-anchor","start"),this.__elementSvgSlopeActText[0].setAttribute("x",(m+35).toString()+"px"))),this.__elementSvgSlopeMinText.css("text-anchor","start"),this.__elementSvgSlopeMinText[0].textContent=i+": "+n,this.__elementSvgSlopeMinText[0].setAttribute("x",(125-250/3+35).toString()+"px"),this.__elementSvgSlopeMinText[0].setAttribute("y",(h+3).toString()+"px"),this.__elementSvgSlopeMaxText.css("text-anchor","end"),this.__elementSvgSlopeMaxText[0].textContent=l+": "+o,this.__elementSvgSlopeMaxText[0].setAttribute("x",(125+250/3-35).toString()+"px"),this.__elementSvgSlopeMaxText[0].setAttribute("y",(r+5).toString()+"px")}}e.SlopeAnalysis=s}(s=e.Analytics||(e.Analytics={})),e.registerEx("SlopeAnalysis","TcHmi.Controls.Analytics",s.SlopeAnalysis)}(e=t.Controls||(t.Controls={}))}(TcHmi||(TcHmi={}));